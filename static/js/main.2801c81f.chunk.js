(this.webpackJsonpluminosia=this.webpackJsonpluminosia||[]).push([[0],{112:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"uploadChannel",(function(){return x})),n.d(t,"updateFirmware",(function(){return k})),n.d(t,"killCurrentProcess",(function(){return T}));var r=n(38),a=n.n(r),o=n(62),i=n(33),c=n(136),s=n(108),u=n.n(s),l=n(30),d=n.n(l),f=n(228),p=n.n(f),h=n(53),b=n(229),j=n.n(b),m=n(230),g=n.n(m),v=n(206).remote.app,O=null,y=null;function x(e,t){return w.apply(this,arguments)}function w(){return(w=Object(o.a)(a.a.mark((function e(t,n){var r,o,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.a.dirSync({unsafeCleanup:!0}),o=d.a.join(r.name,"channel.poi"),c=u.a.tmpNameSync(),n("App Version: ".concat(v?v.getVersion():"unknown","\n")),e.prev=4,e.next=7,C(o,t,n);case 7:return e.next=9,A(r.name,c,n);case 9:if(!y){e.next=15;break}return e.next=12,D(c,"0x150000",O,n);case 12:n("".concat(h.b,"\n")),e.next=16;break;case 15:throw new Error("cancelled");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(4),y?(console.error("Unable to upload channel data:",e.t0),console.trace(),s=e.t0.stack?e.t0.stack:e.t0.toString(),n("".concat(h.d,": ").concat(s,"\n")),O=null):n("".concat(h.c,"\n"));case 21:return y=null,e.prev=22,r.removeCallback(),e.next=26,i.promises.unlink(c);case 26:e.next=30;break;case 28:e.prev=28,e.t1=e.catch(22);case 30:case"end":return e.stop()}}),e,null,[[4,18],[22,28]])})))).apply(this,arguments)}function k(e){return I.apply(this,arguments)}function I(){return(I=Object(o.a)(a.a.mark((function e(t){var n,r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.a.dirSync({unsafeCleanup:!0}),r="firmware.bin",o=d.a.join(n.name,r),t("App Version: ".concat(v?v.getVersion():"unknown","\n")),e.prev=4,e.next=7,M(r,n.name,t);case 7:return e.next=9,D(o,"0x00010000",O,t);case 9:t("".concat(h.b,"\n")),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),y?(console.error("Unable to update firmware:",e.t0),t("".concat(h.d,": ").concat(e.t0,"\n")),O=null):t("".concat(h.c,".\n"));case 15:y=null;try{n.removeCallback()}catch(a){}case 17:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}function C(e,t,n){return S.apply(this,arguments)}function S(){return(S=Object(o.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r("Saving poi channel data to ".concat(t,"...")),e.next=3,i.promises.writeFile(t,n);case 3:r("Done\n");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){var t=function(){if(g.a)return e.cwd();if(v){var t=v.getPath("exe");return d.a.dirname(t)}return e.cwd()}(),n=e.platform,r=e.arch;return d.a.join(t,"resources",n,r)}function A(e,t,n){return R.apply(this,arguments)}function R(){return(R=Object(o.a)(a.a.mark((function e(t,n,r){var o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r("Generating spiffs image ".concat(n,"...\n")),o=E(),r("Script path: ".concat(o,"\n")),i=d.a.join(o,"mkspiffs"),(y=Object(c.spawn)(i,["-c",t,"-b","4096","-p","256","-s","0x2B0000",n])).stdout.on("data",(function(e){var t=e.toString().split(/(\r?\n)/g);r(t.join("\n"))})),y.stderr.on("data",(function(e){var t=e.toString().split(/(\r?\n)/g).join("\n");console.error(t),r("[Error] ".concat(t))})),y.on("error",(function(e){console.error(e),r("[Error] ".concat(e))})),y.on("close",(function(e){e>1&&r("[Error]mkSpiffs exited with code ".concat(e,".\n"))})),e.next=11,y;case 11:r("Done generating spiffs image.\n");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,n,r){return P.apply(this,arguments)}function P(){return(P=Object(o.a)(a.a.mark((function e(t,n,r,o){var i,s,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=E(),o("Script path: ".concat(i,"\n")),s=d.a.join(i,"esptool"),u=["--chip","esp32","--baud","921600","write_flash","-z",n,t],r?(u.unshift("--port",r),o("Uploading to port ".concat(r,"...\n"))):o("Autodetecting port for upload...\n"),(y=Object(c.spawn)(s,u)).stdout.on("data",(function(e){var t=/Serial port ([a-zA-Z0-9]+)/.exec(e);t&&(O=t.length>0?t[1]:null)&&o("\nPort cache set to ".concat(O,".\n"));var n=e.toString().split(/(\r?\n)/g);o(n.join(""))})),y.stderr.on("data",(function(e){var t=e.toString().split(/(\r?\n)/g).join("\n");console.error(t),o("[Error] ".concat(t))})),y.on("error",(function(e){console.error(e),o("[Error] ".concat(e))})),y.on("close",(function(e){e>1&&o("[Error]esptool exited with code ".concat(e,".\n"))})),e.next=12,y;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,n){return N.apply(this,arguments)}function N(){return(N=Object(o.a)(a.a.mark((function e(t,n,r){var o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(e){return e.name===t},o=function(e){return!1===e.prerelease},"gmoehler","ledpoi",!1,r("Downloading firmware '".concat(t,"' to ").concat(n,"...")),e.prev=6,e.next=9,j()("gmoehler","ledpoi",n,o,i,false);case 9:e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(6),y=!0,e.t0;case 15:r("Done.\n");case 16:case"end":return e.stop()}}),e,null,[[6,11]])})))).apply(this,arguments)}function T(){if(y){var e=y.pid;p()(e),y=null}}}.call(this,n(12))},259:function(e,t,n){},269:function(e,t){},271:function(e,t){},280:function(e,t){},282:function(e,t){},308:function(e,t){},309:function(e,t){},314:function(e,t){},316:function(e,t){},323:function(e,t){},342:function(e,t){},415:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),o=n.n(a),i=n(18),c=n.n(i),s=n(19),u=n(31),l=n(208),d=n(2),f="ADD_CHANNEL",p="DELETE_CHANNEL",h="CLEAR_CHANNELS",b="UPDATE_CHANNEL",j="SET_CHANNEL_ACTIVE",m="SET_CHANNEL_INACTIVE",g="PLAY_CHANNELS",v="STOP_CHANNEL",O="STOP_CHANNELS",y="SELECT_ENTITY",x="DESELECT_ENTITY",w="CLEAR_ENTITY_SELECTION",k="COPY_ENTITIES",I="CLEAR_IMAGELIST",C="ADD_IMAGE",S="REMOVE_IMAGE",E="CLEAR_PARTS",A="ADD_PART",R="DELETE_PART",D="MOVE_PART",P="MOVE_PARTS",M="RESIZE_PART",N="CLEAR_MARKERS",T="SET_OR_REPLACE_MARKER",L="DELETE_MARKER",_="UPDATE_MARKER",W="LOAD_SHOW_STARTED",F="LOAD_SHOW_SUCCESS",G="LOAD_SHOW_FAILURE",U="INIT_LOAD_PROGRESS",B="SET_LOAD_PROGRESS",H="INCR_LOAD_PROGRESS;",z="CLEAR_VIEW",V="SELECT_RANGE",K="DESELECT_RANGE",J="SET_RESOLUTION",Y="SELECT_IMAGE_CHANNEL",q="ADD_TO_UPLOAD_LOG",Z="CLEAR_UPLOAD_LOG",X="SET_MESSAGE",$="CLEAR_MESSAGE",Q="TOGGLE_SNAP_TO_MARKER",ee={selection:{from:null,to:null,type:null},resolution:80,selectedImageChannelId:null,partsToCopy:null,uploadLog:null,loadShowStatus:null,message:null,loadProgress:{base:100,progress:0},snapToMarkers:!0},te=function(e){return{from:e.view.selection.from,to:e.view.selection.to,type:e.view.selection.type}},ne=function(e){return e.view.resolution},re=function(e){return e.view.selectedImageChannelId},ae=function(e){return e.view.uploadLog},oe=function(e){return e.view.message},ie=function(e){return"started"===e.view.loadShowStatus},ce=function(e){return e.view.snapToMarkers},se=n(35),ue=n(44),le=Object(u.c)({byImageId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return{};case C:return Object(d.a)(Object(d.a)({},e),{},{[t.payload.imageId]:t.payload});case S:var n=Object(ue.cloneDeep)(e);return delete n[t.payload],n;default:return e}},allImageIds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return[];case C:return[].concat(Object(se.a)(e),[t.payload.imageId]);case S:return e.filter((function(e){return e!==t.payload}));default:return e}}}),de=function(e){return e.entities.images.byImageId},fe=function(e){return Object.values(e.entities.images.byImageId)},pe=function(e,t){return e.entities.images.allImageIds.includes(t)},he=n(45),be=n(42),je=n(25),me=new be.c.Entity("byPartId",{},{idAttribute:"partId"}),ge=Object(u.c)({byPartId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return Object(d.a)(Object(d.a)({},e),t.payload.entities.byPartId);case D:var n=e[t.payload.partId],r=n.actOffset||n.offset||0,a=Oe(r,n.duration,t.payload.incr,t.payload.snapPositions,t.payload.snapDist),o=Object(d.a)(Object(d.a)({},n),a);return Object(d.a)(Object(d.a)({},e),{},{[t.payload.partId]:o});case P:var i=ve(t.payload.partIds,e,t.payload.incr,t.payload.snapPositions,t.payload.snapDist),c=Object(ue.cloneDeep)(e);return t.payload.partIds.forEach((function(n){if(null!==i){var r=e[n],a=r.offset+i,o=(r.actOffset||r.offset)+t.payload.incr;c[r.partId]=Object(d.a)(Object(d.a)({},r),{},{offset:a,actOffset:o})}})),Object(d.a)({},c);case M:var s,u=e[t.payload.partId],l=t.payload.snapDist||.2,f=t.payload.minDuration,p=t.payload.snapPositions;if("left"===t.payload.bound){var h=u.offset+u.duration,b=u.actOffset||u.offset||0,j=ye(b+t.payload.incr,0,h-f),m=xe(j,p,l),g=ye(m,0,h-f);s=Object(d.a)(Object(d.a)({},u),{},{offset:g,duration:h-g,actOffset:j,actRightBound:null})}else{var v=u.actRightBound||u.offset+u.duration,O=ye(v+t.payload.incr,u.offset+f,null),y=xe(O,p,l),x=ye(y-u.offset,f,null);s=Object(d.a)(Object(d.a)({},u),{},{duration:x,offset:u.offset,actRightBound:O,actOffset:null})}return Object(d.a)(Object(d.a)({},e),{},{[t.payload.partId]:s});case R:var w=Object(d.a)({},e);return delete w[t.payload.partId],w;case E:return{};default:return e}},allPartIds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return[].concat(Object(se.a)(e),[t.payload.result]);case R:return e.filter((function(e){return e!==t.payload.partId}));case E:return[];default:return e}}});function ve(e,t,n,r,a){var o=e.reduce((function(e,n){var r=Object(je.a)(e,2),a=r[0],o=r[1];if(null===a||null===o)return[n,n];var i=t[n];return i.offset<t[a].offset?[i.partId,o]:i.offset+i.duration>t[a].offset+t[a].duration?[a,i.partId]:[a,o]}),[null,null]),i=Object(je.a)(o,2),c=i[0],s=i[1],u=(t[c].actOffset||t[c].offset)+n,l=n,d=xe(u,r,a);d!==u?l=d-t[c].offset:l=xe((t[s].actOffset||t[s].offset)+t[s].duration+n,r,a)-(t[s].offset+t[s].duration);return t[c].offset+l<0&&(l=null),l}function Oe(e,t,n,r,a){var o=e+n<0?0:e+n,i=xe(o,r,a),c=i===o?xe(o+t,r,a):i+t;return{offset:c-t<0?0:c-t,duration:t,actOffset:o,actRightBound:null}}function ye(e,t,n){var r=t;if(n){var a=Math.max(t,n);if(r=Math.min(t,n),e>a)return a}return Math.max(e,r)}function xe(e,t,n){var r=function(e,t){var n=t?t.map((function(t){return Math.abs(t-e)})):[],r=n.reduce((function(e,t,n,r){return Number.isInteger(e)&&t>=r[e]?e:n}),null);if(Number.isInteger(r))return{idx:r,diff:n[r]};return{idx:r,diff:null}}(e,t);return Number.isInteger(r.idx)&&r.diff<n?t[r.idx]:e}function we(e,t){return e.entities.parts.allPartIds.includes(t)}function ke(e,t){return e.entities.parts.byPartId[t]}function Ie(e,t){return Object(be.a)(t,[me],e.entities.parts)}function Ce(e,t){return we(e,t)?ke(e,t).channelId:null}var Se=new be.c.Entity("byChannelId",{parts:[me]},{idAttribute:"channelId"}),Ee=[Se],Ae=Object(u.c)({byChannelId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(d.a)(Object(d.a)({},e),t.payload.entities.byChannelId);case p:var n=Object(d.a)({},e);return delete n[t.payload],n;case h:return{};case A:var r=t.payload.result,a=t.payload.entities.byPartId[r],o=Object(d.a)({},e[a.channelId]);if(!o)return e;var i=[].concat(Object(se.a)(o.parts),[r]),c=Math.max(o.duration,a.offset+a.duration);return Object(d.a)(Object(d.a)({},e),{},{[a.channelId]:Object(d.a)(Object(d.a)({},o),{},{parts:i,duration:c})});case R:var s=t.payload.partId,u=t.payload.channelId,l=Object(d.a)({},e[u]),j=l.parts.filter((function(e){return e!==s}));return Object(d.a)(Object(d.a)({},e),{},{[u]:Object(d.a)(Object(d.a)({},l),{},{parts:j})});case b:var m=t.payload.channelId,g=Object(d.a)({},e[m]);return Object(d.a)(Object(d.a)({},e),{},{[m]:Object(d.a)(Object(d.a)({},g),t.payload)});default:return e}},allChannelIds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return[].concat(Object(se.a)(e),[t.payload.result]);case p:return e.filter((function(e){return e!==t.payload}));case h:return[];default:return e}},activeChannels:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return[].concat(Object(se.a)(e),[t.payload]);case p:case m:return e.filter((function(e){return e!==t.payload}));case h:return[];default:return e}},playingChannels:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return[].concat(Object(se.a)(e),Object(se.a)(t.payload));case p:case v:return e.filter((function(e){return e!==t.payload}));case h:case O:return[];default:return e}}});function Re(e){return e.entities.channels.allChannelIds.sort((function(e,t){return e.localeCompare(t)}))}function De(e,t){return Re(e).includes(t)}function Pe(e,t){return e.entities.channels.activeChannels.includes(t)}function Me(e){return 0===e.entities.channels.playingChannels.length}function Ne(e,t){var n=e.entities.channels.activeChannels;return t?n.filter((function(n){return function(e,t){var n=Te(e,t);return n?n.type:0}(e,n)===t})):n}function Te(e,t){return De(e,t)?e.entities.channels.byChannelId[t]:null}function Le(e,t){var n=Te(e,t);return n?n.sampleRate:0}function _e(e,t){var n=Te(e,t);return n?n.snapDist:0}var We=function(e){return 0===function(e){return Re(e).length}(e)?0:e.entities.channels.allChannelIds.reduce((function(t,n){return Math.max(t,function(e,t){var n=Te(e,t);return n?n.duration:0}(e,n))}),0)};function Fe(e){return{byChannelId:e.entities.channels.byChannelId,byPartId:e.entities.parts.byPartId,byImageId:e.entities.parts.byImageId}}var Ge=function(e,t){return De(e,t)?Object(be.a)(t,Se,Fe(e)):null},Ue=function(e){return Object(be.a)(Re(e),Ee,Fe(e))},Be=Object(u.c)({byMarkerId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return{};case T:return Object(d.a)(Object(d.a)({},e),{},{[t.payload.markerId]:t.payload});case L:var n=Object(ue.cloneDeep)(e);return delete n[t.payload],n;case _:var r=e[t.payload.markerId],a=r.pos;t.payload.incr?a=Math.max(0,r.pos+t.payload.incr):"number"==typeof t.payload.pos&&(a=t.payload.pos);var o=t.payload.type||r.type;return Object(d.a)(Object(d.a)({},e),{},{[t.payload.markerId]:Object(d.a)(Object(d.a)({},r),{},{pos:a,type:o})});default:return e}},allMarkerIds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return[];case T:return e.includes(t.payload.markerId)?e:[].concat(Object(se.a)(e),[t.payload.markerId]);case L:return e.filter((function(e){return e!==t.payload}));case _:default:return e}}}),He=function(e,t){return Object.values(e.entities.markers.byMarkerId).filter((function(e){return e.type===t})).map((function(e){return e.pos})).sort()},ze=function(e,t){return e.entities.markers.allMarkerIds.includes(t)},Ve=Object(u.c)({parts:ge,images:le,markers:Be,channels:Ae,selectedEntityIds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return[].concat(Object(se.a)(e),[t.payload]);case x:return e.filter((function(e){return e!==t.payload}));case w:case I:case E:return[];case R:return e.filter((function(e){return e!==t.payload.partId}));case S:return e.filter((function(e){return e!==t.payload}));default:return e}},entityIdsToCopy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(se.a)(t.payload);default:return e}}});function Ke(e,t){return e.entities.images.allImageIds.includes(t)||e.entities.parts.allPartIds.includes(t)}function Je(e,t){return e.entities.selectedEntityIds.includes(t)}function Ye(e,t){return we(e,t)?"part":pe(e,t)?"image":ze(e,t)?"marker":De(e,t)?"channel":"unknown"}function qe(e,t){return["part","image"].includes(Ye(e,t))}function Ze(e){return 0===e.entities.selectedEntityIds.length?"none":Ye(e,e.entities.selectedEntityIds[0])}function Xe(e){return e.entities.selectedEntityIds}function $e(e,t){return Ze(e)===t?Xe(e):[]}function Qe(e){return Xe(e).length>0}function et(e){return e.entities.entityIdsToCopy}var tt=Object(u.c)({view:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return ee;case W:return Object(d.a)(Object(d.a)({},e),{},{loadShowStatus:"started"});case F:return Object(d.a)(Object(d.a)({},e),{},{loadShowStatus:"success"});case G:return Object(d.a)(Object(d.a)({},e),{},{loadShowStatus:"failure"});case U:return Object(d.a)(Object(d.a)({},e),{},{loadProgress:{base:t.payload||100,progress:0}});case B:return Object(d.a)(Object(d.a)({},e),{},{loadProgress:Object(d.a)(Object(d.a)({},e.loadProgress),{},{progress:t.payload})});case H:var n=t.payload||1,r=e.loadProgress.progress+n;return Object(d.a)(Object(d.a)({},e),{},{loadProgress:Object(d.a)(Object(d.a)({},e.loadProgress),{},{progress:r>e.loadProgress.base?e.loadProgress.base:r})});case V:return Object(d.a)(Object(d.a)({},e),{},{selection:{from:t.payload.from,to:t.payload.to,type:t.payload.type}});case K:return Object(d.a)(Object(d.a)({},e),{},{selection:{from:null,to:null,type:null}});case Y:return Object(d.a)(Object(d.a)({},e),{},{selectedImageChannelId:t.payload});case J:return Object(d.a)(Object(d.a)({},e),{},{resolution:t.payload});case q:return Object(d.a)(Object(d.a)({},e),{},{uploadLog:e.uploadLog?e.uploadLog+t.payload:t.payload});case Z:return Object(d.a)(Object(d.a)({},e),{},{uploadLog:null});case X:return Object(d.a)(Object(d.a)({},e),{},{message:t.payload});case $:return Object(d.a)(Object(d.a)({},e),{},{message:null});case Q:return Object(d.a)(Object(d.a)({},e),{},{snapToMarkers:!e.snapToMarkers});default:return e}},entities:Ve}),nt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.d;n(259);var rt=n(9),at=n(7),ot=n(11),it=n(10),ct=n(52),st=n.n(ct),ut=n(8),lt=n(466),dt=n(463),ft=n(464),pt=n(462),ht=n(243),bt=n(465),jt=n(453),mt=n(239),gt=n.n(mt),vt=n(240),Ot=n.n(vt),yt=n(241),xt=n.n(yt),wt=n(468),kt=n(454),It=n.n(kt),Ct=n(455),St=n.n(Ct),Et=n(214),At=n.n(Et),Rt=n(221),Dt=n.n(Rt),Pt=n(216),Mt=n.n(Pt),Nt=n(215),Tt=n.n(Nt),Lt=n(213),_t=n.n(Lt),Wt=n(219),Ft=n.n(Wt),Gt=n(220),Ut=n.n(Gt),Bt=n(217),Ht=n.n(Bt),zt=n(218),Vt=n.n(zt),Kt=n(222),Jt=n.n(Kt),Yt=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).loadShowFromFile=function(e){e.preventDefault(),r.props.loadShowFromFile(e.target.files[0])},r.loadAudioFromFile=function(e){e.preventDefault(),r.props.loadAudioFromFile(e.target.files[0])},r.handleChannelSelectionChange=function(e){var t=e.target.value;r.state[e.target.name]&&r.props.setChannelInactive(r.state[e.target.name]),r.props.setChannelActive(t),r.setState({[e.target.name]:t})},r.state={channelId:""},r}return Object(at.a)(n,[{key:"componentDidUpdate",value:function(){this.state.channelId&&!this.props.channelIds.includes(this.state.channelId)&&this.setState({channelId:this.props.channelIds[0]})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.createImageChannel,o=t.saveShow,i=t.enablePlay,c=t.playChannelAndImage,s=t.enableStop,u=t.stopChannel,l=t.zoomIn,d=t.zoomOut,f=t.entitySelected,p=t.deleteSelectedEntities,h=t.copyParts,b=t.pasteParts,j=t.hasPartsToCopy,m=t.updateFirmware;return Object(r.jsxs)("div",{className:n.wrapper,children:[Object(r.jsxs)("div",{className:n.headergroup,children:[Object(r.jsx)(wt.a,{title:"Load audio",children:Object(r.jsx)(jt.a,{color:"inherit",onClick:function(){e.fileUpload.value="",e.fileUpload.click()},children:Object(r.jsx)(_t.a,{})})}),Object(r.jsx)("input",{type:"file",accept:"audio/*",hidden:!0,ref:function(t){return e.fileUpload=t},onChange:this.loadAudioFromFile,width:0}),Object(r.jsx)(wt.a,{title:"Add image channel",children:Object(r.jsx)(jt.a,{color:"inherit",onClick:a,children:Object(r.jsx)(At.a,{})})}),Object(r.jsx)(wt.a,{title:"Load show",children:Object(r.jsx)(jt.a,{color:"inherit",onClick:function(){return e.loadShow.click()},children:Object(r.jsx)(Tt.a,{})})}),Object(r.jsx)("input",{type:"file",hidden:!0,value:"",ref:function(t){return e.loadShow=t},onChange:this.loadShowFromFile,width:0}),Object(r.jsx)(wt.a,{title:"Save show",children:Object(r.jsx)(jt.a,{color:"inherit",onClick:o,children:Object(r.jsx)(Mt.a,{})})})]}),Object(r.jsxs)("div",{className:n.headergroup,children:[Object(r.jsx)(wt.a,{title:"Play",children:Object(r.jsx)("div",{children:Object(r.jsx)(jt.a,{color:"inherit",disabled:!i,onClick:function(){return c(e.state.channelId)},children:Object(r.jsx)(Ht.a,{})})})}),Object(r.jsx)(wt.a,{title:"Stop",children:Object(r.jsx)("div",{children:Object(r.jsx)(jt.a,{color:"inherit",disabled:!s,onClick:u,children:Object(r.jsx)(Vt.a,{})})})})]}),Object(r.jsxs)("div",{className:n.headergroup,children:[Object(r.jsx)(wt.a,{title:"Zoom in",children:Object(r.jsx)(jt.a,{color:"inherit",onClick:l,children:Object(r.jsx)(Ft.a,{})})}),Object(r.jsx)(wt.a,{title:"Zoom out",children:Object(r.jsx)(jt.a,{color:"inherit",onClick:d,children:Object(r.jsx)(Ut.a,{})})}),Object(r.jsx)(wt.a,{title:"Copy selected part",children:Object(r.jsx)("div",{children:Object(r.jsx)(jt.a,{disabled:!f,color:"inherit",onClick:h,children:Object(r.jsx)(It.a,{})})})}),Object(r.jsx)(wt.a,{title:"Paste part",children:Object(r.jsx)("div",{children:Object(r.jsx)(jt.a,{disabled:!j,color:"inherit",onClick:b,children:Object(r.jsx)(St.a,{})})})}),Object(r.jsx)(wt.a,{title:"Delete selected",children:Object(r.jsx)("div",{children:Object(r.jsx)(jt.a,{disabled:!f,color:"inherit",onClick:p,children:Object(r.jsx)(Dt.a,{})})})})]}),Object(r.jsx)("div",{className:n.headergroup,children:Object(r.jsx)(wt.a,{title:"Update firmware",children:Object(r.jsx)(jt.a,{color:"secondary",onClick:m,children:Object(r.jsx)(Jt.a,{})})})})]})}}]),n}(a.Component),qt=Object(ut.a)((function(e){return{root:{color:"white"},wrapper:{display:"flex",justifyContent:"center",flexDirection:"row",margin:0,padding:"0 30px",whiteSpace:"nowrap"},headergroup:{display:"flex",justifyContent:"center",flexDirection:"row",margin:"0 10px"}}}),{withTheme:!0})(Yt),Zt=n(16),Xt=n(13),$t=0;function Qt(e){return["insert","selected","timeScale","insertTimeScale"].includes(e)}function en(e){return function(t,n){var r;Qt(e)?Object.values((r=n(),Object.values(r.entities.markers.byMarkerId))).forEach((function(n){n.type===e&&t(nn(n.markerId))})):console.error("cannot clear markers of unknown type:",e)}}function tn(e){return function(t,n){return"number"==typeof e.pos&&Qt(e.type)?(e.markerId||(e.markerId="marker-"+(++$t).toString()),t(function(e){return{type:T,payload:e}}(Object(d.a)({},e))),e.markerId):(console.error("cannot set or replace incomplete marker:",e),null)}}var nn=function(e){return{type:L,payload:e}};function rn(e){return function(t,n){ze(n(),e)&&t(nn(e))}}var an=function(e){return function(t,n){e.markerId?ze(n(),e.markerId)&&(e.incr||"number"==typeof e.pos||e.type)&&t(function(e){return{type:_,payload:e}}(e)):console.error("marker does not have enough information to be updated:",e)}};function on(e,t){return"".concat(e,"--").concat(t)}function cn(e){return on(e,"left")}function sn(e){return on(e,"right")}var un=function(e){return function(t,n){t(tn(function(e){return{markerId:cn(e.partId),pos:e.offset,type:"selected",channelId:e.channelId,partId:e.partId}}(e))),t(tn(function(e){return{markerId:sn(e.partId),pos:e.offset+e.duration,type:"selected",channelId:e.channelId,partId:e.partId}}(e)))}},ln=function(e){return function(t,n){t(rn(cn(e))),t(rn(sn(e)))}};function dn(e){return function(t,n){if((e.filename||e.imageId)&&e.src&&e.width&&e.height){var r=e.imageId||e.filename;if(!pe(n(),r))return t(function(e){return{type:C,payload:e}}(Object(d.a)(Object(d.a)({},e),{},{imageId:r}))),r}return null}}function fn(e){return function(t,n){pe(n(),e)&&t(function(e){return{type:S,payload:e}}(e))}}function pn(e){var t="image_"+e.imageId,n=JSON.stringify(e);localStorage.setItem(t,n)}function hn(){return function(e,t){return Object.keys(localStorage).filter((function(e){return e.startsWith("image_")})).reduce((function(e,t){var n=JSON.parse(localStorage.getItem(t));return e.push(n),e}),[]).forEach((function(t){return e(dn(t))}))}}var bn=0;function jn(){return"part-"+(++bn).toString()}var mn=function(e){return{type:A,payload:Object(d.a)({},Object(be.b)(e,me))}},gn=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n,r){if(e.imageId&&null!=e.channelId&&null!=e.offset&&null!=e.duration){var a=jn();return n(mn(Object(d.a)(Object(d.a)({},e),{},{partId:a}))),t&&n(An(a)),a}return console.error("cannot add incomplete part:",e),null}},vn=function(e){return function(t,n){var r=Ce(n(),e);e&&null!=r?(t({type:R,payload:{partId:e,channelId:r}}),t(ln(e))):console.error("cannot remove non-existing part:",e)}},On=function(e){return function(t,n){if(Je(n(),e.partId)||t(An(e.partId)),e.incr){var r=$e(n(),"part"),a=[],o=null;if(ce(n())){a=He(n(),"timeScale");var i=Ce(n(),e.partId);o=_e(n(),i)}t(function(e,t,n,r){return{type:P,payload:{partIds:e,incr:t,snapPositions:n,snapDist:r}}}(r,e.incr,a,o)),r.forEach((function(e){return t(xn(e))}))}}},yn=function(e){return function(t,n){if(e.partId&&e.markerId){if(t(An(e.partId)),e.incr){var r=Ce(n(),e.partId);e.bound=e.markerId.includes("right")?"right":"left";var a=[],o=null,i=function(e,t){var n=Te(e,t);return n?n.minPartDuration:0}(n(),r);ce(n())&&(a=He(n(),"timeScale"),o=_e(n(),r)),t(function(e,t,n,r){return{type:M,payload:Object(d.a)(Object(d.a)({},e),{},{snapPositions:t,snapDist:n,minDuration:r})}}(e,a,o,i)),t(xn(e.partId))}}else console.error("part does not have enough information to be resized:",e)}},xn=function(e){return function(t,n){var r=ke(n(),e);r?t(function(e){return function(t,n){var r=cn(e.partId);t(an({pos:e.offset,markerId:r}));var a=sn(e.partId);t(an({pos:e.offset+e.duration,markerId:a}))}}(r)):console.error("part to sync deps for does not exist:",e)}},wn=function(e,t,n){return function(e,r){(function(e,t,n,r){return Ie(e,function(e){return e.entities.parts.allPartIds}(e)).filter((function(e){return e.offset+e.duration<r&&e.offset>n})).map((function(e){return e.partId}))})(r(),0,t,n).forEach((function(t){return e(kn(t))}))}};function kn(e){return function(t,n){if(Ke(n(),e)&&qe(n(),e)){if(!Je(n(),e)&&(t(function(e){return{type:y,payload:e}}(e)),we(n(),e))){var r=ke(n(),e);t(un(r))}}else console.error("entity to select does not exist or is not selectable:",e)}}function In(e){return function(t,n){Ke(n(),e)&&qe(n(),e)?(t(function(e){return{type:x,payload:e}}(e)),we(n(),e)&&t(ln(e))):console.error("entity to deselect does not exist or is not selectable:",e)}}function Cn(){return function(e,t){e({type:w}),e(en("selected")),e(en("insert"))}}function Sn(){return function(e,t){var n=Ze(t());Xe(t()).forEach((function(t){"part"===n?e(vn(t)):"image"===n&&e(fn(t))}))}}function En(){return function(e,t){var n=$e(t(),"part");n.length>0&&e({type:k,payload:n})}}function An(e){return function(t,n){if(e&&Ke(n(),e)){var r=function(e,t){return e.entities.selectedEntityIds===[t]}(n(),e);t(Cn()),r||t(kn(e))}}}function Rn(e){return function(t,n){e&&Ke(n(),e)&&(Ye(n(),e)!==Ze(n())?(t(Cn()),t(kn(e))):Je(n(),e)?t(In(e)):t(kn(e)))}}function Dn(e,t){return e/t}function Pn(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n?Math.ceil(e*t):Math.floor(e*t)}function Mn(e,t){return e/t}function Nn(e,t){return Math.ceil(e*t)}function Tn(e,t,n){var r=e*n/t%1;return 2*Math.PI*r}var Ln=function(e){return{type:V,payload:e}},_n=function(){return{type:K}},Wn=function(e){return function(t,n){t(function(e){return{type:J,payload:e}}(e)),Re(n()).forEach((function(r){return t(gr({channelId:r,minPartDuration:Mn(5,e,Le(n(),r)),snapDist:Mn(10,e,Le(n(),r))}))}))}},Fn=function(e){return{type:q,payload:e}},Gn=function(e){return{type:X,payload:e}},Un={count:0};function Bn(e,t){switch(t.type){case"reset":return{count:0};case"increment":return{count:e.count+1};case"decrement":return{count:e.count-1};default:throw new Error}}function Hn(e){var t=Object(a.useState)(!1),n=Object(je.a)(t,2),r=n[0],o=n[1],i=Object(a.useReducer)(Bn,Un),c=Object(je.a)(i,2),u=c[0],l=c[1],d=Object(s.c)();function f(e,t){switch(t.preventDefault(),t.stopPropagation(),e){case"mouseUp":!function(e){var t=e.target.getAttribute("data-imageid");e.ctrlKey?d(Rn(t)):d(An(t))}(t);break;case"dragEnter":l({type:"increment"}),o(!0);break;case"dragLeave":l({type:"decrement"}),u.count<=0&&(o(!1),l({type:"reset"}));break;case"drop":!function(e){if(o(!1),l({type:"reset"}),e.dataTransfer.files&&e.dataTransfer.files.length>0)for(var t=e.dataTransfer.files,n=0;n<t.length;n++)p(t[n])}(t)}}function p(t){var n=new FileReader,r=new Image;n.onload=function(e){r.src=n.result},r.onload=function(){if(30!==r.height)d(Gn({type:"error",title:"Wrong image size",text:"The dragged image ".concat(t.name," has a height of ").concat(r.height,". However, you can only add images with a height of 30 pixels.")}));else{var a={width:r.width,height:r.height,src:n.result,filename:t.name,sampleRate:e,duration:Dn(r.width,e)};d(dn(a))}},n.readAsDataURL(t)}return[function(e,t){return f(e,t)},r]}function zn(){var e=Object(Zt.a)(["\n\twidth: 100%;\n\tpadding-top: 80px;\n\ttext-align: center;\n\tjustify-content: center;\n\tfont-size: 14pt;\n\tfont-weight: 600;\n\tcolor: darkgrey;\n"]);return zn=function(){return e},e}function Vn(){var e=Object(Zt.a)(["\n\tmargin: 3px;\n\tmax-height: 30px;\n\tborder: 2px solid ",";\n"]);return Vn=function(){return e},e}function Kn(){var e=Object(Zt.a)(["\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-content: flex-start;\n\twidth: calc(100% - 16px);\n\theight: 100%;\n\toverflow: auto;\n\tflex-wrap: wrap;\n\tmargin: 20px 8px;\n\tbackground:  ",";\n\tborder: 3px dashed ","; \n\tborder-radius: 10px;\n"]);return Kn=function(){return e},e}var Jn=Xt.a.div(Kn(),(function(e){return e.backgroundColor}),(function(e){return e.borderColor})),Yn=Xt.a.img(Vn(),(function(e){return e.borderColor})),qn=Xt.a.label(zn());var Zn=function(e){var t=e.images,n=e.sampleRate;Object(a.useEffect)((function(){e.loadImagesFromStorage()}),[]);var o=Hn(n),i=Object(je.a)(o,2),c=i[0],s=i[1],u=t.map((function(t){return Object(r.jsx)(Yn,{id:t.imageId,src:t.src,"data-imageid":t.imageId,borderColor:e.isEntitySelected(t.imageId)?"red":"transparent",draggable:!0,onDragStart:function(e){e.dataTransfer.setData("imageid",t.imageId),e.dataTransfer.setData("duration",t.duration)}},t.imageId)})),l=t.length>0?null:Object(r.jsx)(qn,{center:!0,children:" Drop your images here "});return Object(r.jsxs)(Jn,{borderColor:t.length>0?"tranparent":"darkgrey",onMouseUp:function(e){return c("mouseUp",e)},onDragEnter:function(e){return c("dragEnter",e)},onDragEnd:function(e){return c("dragEnd",e)},onDragExit:function(e){return c("dragExit",e)},onDragLeave:function(e){return c("dragLeave",e)},onDragOver:function(e){return c("dragOver",e)},onDrop:function(e){return c("drop",e)},backgroundColor:s?"darkgrey":"white",children:[l,u]})},Xn=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(){return Object(rt.a)(this,n),t.apply(this,arguments)}return Object(at.a)(n,[{key:"render",value:function(){return Object(r.jsx)(Zn,Object(d.a)(Object(d.a)({},this.props),{},{sampleRate:100,selectImage:this.props.toggleEntitySelection,selectMultiImage:this.props.toggleMultiEntitySelection}))}}]),n}(a.Component),$n=Object(s.b)((function(e,t){return{images:fe(e),isEntitySelected:function(t){return Je(e,t)}}}),(function(e){return{addImage:function(t){return e(dn(t))},setMessage:function(t,n,r){return e(Gn({text:t,type:n,title:r}))},toggleEntitySelection:function(t){return e(An(t))},toggleMultiEntitySelection:function(t){return e(Rn(t))},saveImageToStorage:function(t,n){return e(pn(t))},loadImagesFromStorage:function(){return e(hn())}}}))(Xn),Qn=n(76),er=n.n(Qn),tr=n(226),nr=n.n(tr),rr=n(227);function ar(e,t){var n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function or(e){return function(e){var t=new ArrayBuffer(3+4*e.width*e.height),n=new Uint8Array(t),r=0,a=0,o=[-1,-1,-1];n[r++]=1,n[r++]=e.height;var i=Math.floor(e.width/256);n[r++]=i,n[r++]=e.width-256*i;for(var c=0;c<e.width;c++){var s=4*c;o=[e.data[s],e.data[s+1],e.data[s+2]],a=1;for(var u=1;u<e.height;u++){var l=4*(u*e.width+c);o[0]===e.data[l]&&o[1]===e.data[l+1]&&o[2]===e.data[l+2]?a++:(n[r++]=o[0],n[r++]=o[1],n[r++]=o[2],n[r++]=a,o=[e.data[l],e.data[l+1],e.data[l+2]],a=1)}n[r++]=o[0],n[r++]=o[1],n[r++]=o[2],n[r++]=a}return console.log("orig size: ".concat(e.width,"x").concat(e.height,": ").concat(3*e.width*e.height," bytes")),console.log("enc. size: ".concat(r," bytes, reduction: ").concat(100-Math.round(100*r/(3*e.width*e.height)),"%")),n.subarray(0,r)}(e)}var ir=new nr.a(0,100),cr=function(e){return function(t,n){var r,a;return t({type:W,payload:r}),console.log("Reading ".concat(e.name,"...")),(a=e,new Promise((function(e,t){var n=new FileReader;n.onload=function(){e(n.result)},n.readAsText(a)}))).then((function(e){var n=JSON.parse(e);return t(sr(n))})).then((function(){return t({type:F,payload:e});var e})).catch((function(e){return console.error(e),t({type:G,payload:{err:e}})}))}},sr=function(e){return function(t,n){console.log(e);var r=e.images.filter((function(e){return!pe(n(),e.imageId)})).map((function(e){return function(e){if(e.src.startsWith("data:image"))return Promise.resolve(e)}(e).then((function(e){return console.log("loading image ".concat(e.imageId)),t(dn(e))}))})),a=e.markers?e.markers.map((function(e){return t(tn(e))})):[];return Promise.all(r).then((function(){return console.log("images loaded."),Promise.all(a)})).then((function(){console.log("markers loaded.");var n=e.channels.map((function(e){"image"===e.type?t(jr(e))?console.log("".concat(e.type," channel added.")):console.log("Loading image channel failed. Skipped channel..."):console.log("Loading channel with type ".concat(e.type," is not supported. Skipped channel..."));return Promise.resolve()}));return Promise.all(n)}))}};var ur=function(){return function(e,t){var n,r,a,o,i,c,s={markers:(a=t(),o="timeScale",Object.values(a.entities.markers.byMarkerId).filter((function(e){return e.type===o})).map((function(e){return Object(ue.omit)(e,["markerId"])}))),images:fe(t()),channels:(n=Ue(t()),r=["partId","channelId"],JSON.parse(JSON.stringify(n,(function(e,t){return r.includes(e)?void 0:t}))))};i="show.json",c=JSON.stringify(s),ar(i,"data:application/json;charset=utf-8,"+encodeURIComponent(c))}},lr=function(e){return function(t,n){if(e){var r=We(n()),a=document.getElementById("imageExportCanvas");a.height=30*e,a.width=Pn(r,100);var o=a.getContext("2d");o.fillStyle="black",o.fillRect(0,0,a.width,a.height)}}},dr=function(e,t,n){return function(r,a){var o=function(e,t){var n=Te(e,t);return n?n.gain:0}(a(),e),i=Le(a(),e),c=function(e,t){var n=Te(e,t);return n?Ie(e,n.parts):[]}(a(),e);if(c){var s=document.getElementById("imageExportCanvas"),u=s.getContext("2d");if(c.forEach((function(e){var n=document.getElementById(e.imageId),r=e.offset?Pn(e.offset,i):0,a=e.duration?Pn(e.duration,i):0;u.drawImage(n,0,0,n.width,30,r,30*t,a,30)})),o&&o<.99){var l=n?ir.linearToLogarithmic(o)/100:o;u.fillStyle="black",u.globalAlpha=1-l,u.fillRect(0,30*t,s.width,30)}}}},fr=function(e){return function(t,n){t(lr(1)),t(dr(e,0,!0));var r=pr();!function(e,t){var n=new Blob([t],{type:"data:application/octet-stream;base64"});Object(rr.saveAs)(n,e)}("result-".concat(e,".poi"),or(r))}},pr=function(e,t,n){var r=document.getElementById("imageExportCanvas");if(r){var a=r.getContext("2d"),o=e?Pn(e,n):0,i=(t?Pn(t,n,!1):r.width)-o;if(i>0)return a.getImageData(o,0,i,r.height)}return{width:0,height:0,data:[]}},hr=function(e,t){return function(n,r){return n({type:"LOAD_AUDIO_STARTED"}),console.log("Reading "+e.name+"..."),function(e,t){return new Promise((function(n,r){var a=new FileReader;a.onload=function(){t.decodeAudioData(a.result).then((function(e){return n(e)}))},a.readAsArrayBuffer(e)}))}(e,t).then((function(t){var r={type:"audio",playState:"stopped",src:e.name,offset:0,sampleRate:t.sampleRate,gain:1,buffer:t,duration:t.duration,active:!0,parts:[]};n(jr(r)),n({type:"LOAD_AUDIO_SUCCESS"}),console.log("File read.")})).catch((function(e){return console.error(e),n({type:"LOAD_AUDIO_FAILURE",payload:{err:e}})}))}},br=0;var jr=function(e){return function(t,n){if(e.sampleRate&&e.duration&&Array.isArray(e.parts)&&("image"===e.type||"audio"===e.type&&e.buffer&&e.src)){e.gain=e.gain||1,e.channelId="channel-"+e.type+"-"+(++br).toString(),e.minPartDuration=Mn(5,ne(n()),e.sampleRate),e.snapDist=Mn(10,ne(n()),e.sampleRate);var r=e.parts;return t(function(e){return{type:f,payload:Object(be.b)(e,Se)}}(Object(d.a)(Object(d.a)({},e),{},{parts:[]}))),r.forEach((function(n){t(gn(Object(d.a)(Object(d.a)({},n),{},{channelId:e.channelId}),!1))})),t(vr(e.channelId)),e.channelId}return console.error("cannot add incomplete channel:",e),null}},mr=function(e){return function(t,n){null!=e&&De(n(),e)?(function(e,t){var n=Te(e,t);return n?n.parts:0}(n(),e).forEach((function(e){t(vn(e))})),t(function(e){return{type:p,payload:e}}(e))):console.error("cannot remove non-existing channelId:",e)}},gr=function(e){return function(t,n){var r=e.channelId,a=Object(he.a)(e,["channelId"]);if(null!=r&&De(n(),r)&&a)return t(function(e){return{type:b,payload:e}}(e));console.error("cannot update channel:",e)}},vr=function(e){return{type:j,payload:e}},Or=function(e){return{type:m,payload:e}},yr=function(){return function(e,t){var n=Ne(t());e({type:g,payload:n})}};window.AudioContext=window.AudioContext||window.webkitAudioContext;var xr=window.AudioContext&&new window.AudioContext,wr=[4e3,2e3,1e3,500,250,125,80,40,20,10,5],kr=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).resetZoom=function(){r.resolutionIdx=6,r.props.setResolution(wr[r.resolutionIdx])},r.zoomIn=function(){r.resolutionIdx=Math.min(Math.max(parseInt(r.resolutionIdx)-1,0),wr.length-1),r.props.setResolution(wr[r.resolutionIdx])},r.zoomOut=function(){r.resolutionIdx=Math.min(Math.max(parseInt(r.resolutionIdx)+1,0),wr.length-1),r.props.setResolution(wr[r.resolutionIdx])},r.resolutionIdx=6,r}return Object(at.a)(n,[{key:"render",value:function(){return Object(r.jsx)(qt,Object(d.a)(Object(d.a)({},this.props),{},{zoomIn:this.zoomIn,zoomOut:this.zoomOut}))}}]),n}(a.Component),Ir=Object(s.b)((function(e){return{channelIds:Re(e),entitySelected:Qe(e),hasPartsToCopy:et(e).length>0,enablePlay:Boolean(Re(e).length>0&&Me(e)),enableStop:Boolean(Re(e).length&&!Me(e))}}),(function(e){return{saveShow:function(){return e(ur())},loadShowFromFile:function(t){return e(cr(t))},loadAudioFromFile:function(t){return e(hr(t,xr))},createImageChannel:function(){return e((function(e,t){var n=Math.max(10,We(t()));return e(jr({type:"image",sampleRate:100,duration:n,parts:[]}))}))},playChannelAndImage:function(t){return e((function(e,t){var n=Ne(t(),"image");e(lr(n.length)),n.map((function(t,n){return e(dr(t,n))})),e(yr())}))},stopChannel:function(){return e({type:O})},setResolution:function(t){return e(Wn(t))},deleteSelectedEntities:function(){return e(Sn())},setChannelActive:function(t){return e(vr(t))},setChannelInactive:function(t){return e(Or(t))},copyParts:function(){return e(En())},pasteParts:function(){return e((function(e,t){et(t()).forEach((function(n){var r=ke(t(),n),a=re(t());if(a){var o=Object(d.a)(Object(d.a)({},r),{},{channelId:a});e(gn(o))}}))}))},updateFirmware:function(){return e((function(e,t){er()()?n(112).updateFirmware((function(t){console.log(t),e(Fn(t))})):console.error("Firmware update only implemented for Electron.")}))}}}))(kr),Cr=n(231),Sr=n.n(Cr),Er=n(232),Ar=n.n(Er),Rr=n(233),Dr=n.n(Rr),Pr=n(234),Mr=n.n(Pr);function Nr(){var e=Object(Zt.a)(["\n  display: flex\n  justify-content: center;\n  flex-direction: row;\n  margin: 0;\n  padding: 0 20px;\n"]);return Nr=function(){return e},e}var Tr=Xt.a.div(Nr()),Lr=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(){return Object(rt.a)(this,n),t.apply(this,arguments)}return Object(at.a)(n,[{key:"render",value:function(){var e=this.props,t=e.loadImagesFromStorage,n=e.saveImagesToStorage,a=e.clearImagesfromStorage,o=e.clearImageList;return Object(r.jsxs)(Tr,{children:[Object(r.jsx)(wt.a,{title:"Restore images from store",children:Object(r.jsx)(jt.a,{color:"primary",onClick:t,children:Object(r.jsx)(Sr.a,{})})}),Object(r.jsx)(wt.a,{title:"Save images to store",children:Object(r.jsx)(jt.a,{color:"primary",onClick:n,children:Object(r.jsx)(Ar.a,{})})}),Object(r.jsx)(wt.a,{title:"Clear store",children:Object(r.jsx)(jt.a,{color:"primary",onClick:a,children:Object(r.jsx)(Dr.a,{})})}),Object(r.jsx)(wt.a,{title:"Clear images",children:Object(r.jsx)(jt.a,{color:"primary",onClick:o,children:Object(r.jsx)(Mr.a,{})})})]})}}]),n}(a.Component),_r=Object(ut.a)((function(e){return{root:{color:"white"},formControl:{margin:e.spacing(1),minWidth:80}}}),{withTheme:!0})(Lr),Wr=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(){return Object(rt.a)(this,n),t.apply(this,arguments)}return Object(at.a)(n,[{key:"render",value:function(){return Object(r.jsx)(_r,Object(d.a)({},this.props))}}]),n}(a.Component),Fr=Object(s.b)((function(e){return{}}),(function(e){return{loadImagesFromStorage:function(){return e(hn())},saveImagesToStorage:function(){return e((function(e,t){fe(t()).forEach((function(e){return pn(e)}))}))},clearImagesfromStorage:function(){return e((function(e,t){return Object.keys(localStorage).filter((function(e){return e.startsWith("image_")})).forEach((function(e){return localStorage.removeItem(e)}))}))},clearImageList:function(){return e({type:I})}}}))(Wr),Gr=n(416),Ur=n(467),Br=n(469);function Hr(){var e=Object(Zt.a)(["\n  position: absolute;\n  left: ","px;\n  background: ",";\n  width: ","px;\n  height: 100%;\n  border: 1px solid ",";\n"]);return Hr=function(){return e},e}function zr(){var e=Object(Zt.a)(["\n  position: absolute;\n  background: ",";\n  width: 2px;\n  left: ","px;\n  height: 100%;\n  cursor: ",";\n  z-index: ",";\n"]);return zr=function(){return e},e}function Vr(){var e=Object(Zt.a)(["\n  position: absolute;\n  background: ",";\n  width: 1px;\n  left: ","px;\n  height: 100%;\n  border-right: 1px solid ",";\n"]);return Vr=function(){return e},e}var Kr=Xt.a.div(Vr(),(function(e){return e.theme.waveProgressColor}),(function(e){return e.progress}),(function(e){return e.theme.waveProgressBorderColor})),Jr=Xt.a.div(zr(),(function(e){return e.color||e.theme.markerColor}),(function(e){return e.markerPos}),(function(e){return e.cursor}),(function(e){return e.zIndex})),Yr=Xt.a.div(Hr(),(function(e){return e.selection.from}),(function(e){return"temp"===e.selection.type?e.theme.tempSelectionColor:e.theme.selectionColor}),(function(e){return e.selection.to-e.selection.from}),(function(e){return e.theme.selectionColor}));function qr(e){var t=o.a.useState(null),n=Object(je.a)(t,2),i=n[0],c=n[1],s=function(e){c(e.currentTarget)},u=function(){c(null)},l=e.channelId,f=e.progress,p=e.selection,h=e.markers,b=e.theme,j=f?Object(r.jsx)(Kr,{className:"Progress",progress:f,theme:b}):null,m=p&&p.from&&p.to?Object(r.jsx)(Yr,{className:"Selection",selection:p,theme:b}):null,g=h&&Array.isArray(h)?h.map((function(e){var t=b.markerColor,n="default",a=!1,o=1;"insert"===e.type?t=b.insertMarkerColor:"insertTimeScale"===e.type?(t=b.insertMarkerColor,n="copy"):"timeScale"===e.type?(n="ew-resize",a=!0,o=10):"selected"===e.type&&e.channelId===l?(t=b.selectedMarkerColor,n="col-resize"):"selected"===e.type?t=b.selectedMarkerColorOther:e.channelId!==l&&(t=b.markerColorOther);var i={key:e.markerId,className:"Marker",markerPos:e.pos,onContextMenu:a?s:null,color:t,cursor:n,theme:b,"data-markerid":e.markerId,"data-markertype":e.type,"data-partid":e.partId,zIndex:o};return Object(r.jsx)(Jr,Object(d.a)({},i))})):null,v=Object(r.jsx)(Ur.a,{id:"simple-menu",anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:u,children:Object(r.jsx)(Br.a,{onClick:function(){return function(t){var n=t.getAttribute("data-markerid");e.deleteMarker(n),e.deleteMarker("insertTimeScaleId"),u()}(i)},children:"Remove marker"})});return Object(r.jsxs)(a.Fragment,{children:[j,m,g,v]})}qr.defaultProps={progress:null,selection:null,markers:[]};var Zr=Object(Xt.b)(qr),Xr=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).state={error:null},r}return Object(at.a)(n,null,[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),Object(at.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"render",value:function(){return this.state.error?Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:" ERROR! Cannot continue. "}),this.state.error.message?Object(r.jsxs)("p",{children:[this.state.error.message," "]}):null,this.state.error.stack?Object(r.jsxs)("p",{children:[this.state.error.stack," "]}):null]}):Object(r.jsx)(Zr,Object(d.a)(Object(d.a)({},this.props),{},{className:"ChannelMarkers"}))}}]),n}(a.Component),$r=Object(s.b)((function(e,t){var n=t.channelId,r=t.progress,a=ne(e),o=re(e),i=r?Nn(r,a)-0:0,c=te(e),s=c?{from:c.from?Nn(c.from,a)-0:0,to:c.to?Nn(c.to,a)-0:0,type:c.type}:null,u=function(e){return e.entities.markers.allMarkerIds.sort((function(e,t){return e.localeCompare(t)}))}(e),l=[];return u.forEach((function(t){var n=Object(ue.cloneDeep)(function(e,t){return e.entities.markers.byMarkerId[t]}(e,t));n.pos=n.pos?Nn(n.pos,a)-0:0,l.push(n)})),{channelId:n,progress:i,markers:l,selection:s,selected:n===o}}),(function(e){return{deleteMarker:function(t){return e(rn(t))}}}))(Xr);function Qr(e){var t=Object(a.useState)(null),n=Object(je.a)(t,2),r=n[0],o=n[1],i=Object(a.useState)(null),c=Object(je.a)(i,2),u=c[0],l=c[1],d=Object(a.useState)(null),f=Object(je.a)(d,2),p=f[0],h=f[1],b=Object(a.useState)(null),j=Object(je.a)(b,2),m=j[0],g=j[1],v=Object(a.useState)(null),O=Object(je.a)(v,2),y=O[0],x=O[1],w=Object(s.c)();function k(e,t){var n=function(e){var t=e.split("-");return t.pop(),t.length?t.join("-"):null}(e);"keyDown"===e?function(e){"Delete"!==e.key&&"Backspace"!==e.key||w(Sn())}(t):e.includes("mouseDown")?function(e,t){e.channelId&&(o(e.x),l(e.partId),h(e.markerId),g(t),x("anyMouseAction"),w(_n()),e.partId&&!t?w((n=e.partId,function(e,t){n&&Ke(t(),n)&&(Je(t(),n)||(e(Cn()),e(kn(n))))})):e.partId||w(Ln({from:e.x,to:e.x,type:"temp"})));var n}(t,n):e.includes("mouseMove")?y&&C(t,!1):e.includes("mouseUp")?"anyMouseAction"===y?("ctrl-mouseUp"===e?function(e){w(Rn(e.partId))}(t):function(e){e.partId&&w(An(e.partId));e.channelId&&w(function(e){return{type:Y,payload:e}}(e.channelId))}(t),I()):y&&C(t,!0):e.includes("mouseLeave")&&y&&C(t,!0)}function I(){"selectRange"!==y&&w(_n()),o(null),l(null),h(null),g(null),x(null)}function C(t,n){var a=t.x-r;Math.abs(a)>0&&(["anyMouseAction","moveResize"].includes(y)&&!m&&r&&u&&e?(!function(t){"anyMouseAction"===y&&x("moveResize");w(p?yn({channelId:e,partId:u,markerId:p,incr:t}):On({partId:u,incr:t}))}(a),o(t.x)):["anyMouseAction","selectRange"].includes(y)&&"shift"===m&&r&&e?function(e){"anyMouseAction"===y&&x("selectRange");var t=Math.min(r,e),n=Math.max(r,e);w(Ln({from:t,to:n}))}(t.x):["anyMouseAction","selectPartInRange"].includes(y)&&r&&e&&function(e){"anyMouseAction"===y&&x("selectPartInRange");var t=Math.min(r,e),n=Math.max(r,e);w(Ln({from:t,to:n,type:"temp"})),w(wn(0,t,n))}(t.x)),n&&I()}return function(e,t){return k(e,t)}}function ea(){var e=Object(a.useState)(null),t=Object(je.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(0),i=Object(je.a)(o,2),c=i[0],u=i[1],l=Object(s.c)();function f(e,t){switch(e){case"dragEnter":case"dragOver":p(t);break;case"drop":!function(e){e.channelId&&e.imageId?l((t={channelId:e.channelId,imageId:e.imageId,offset:e.x},function(e,n){e(rn("insert"));var r=function(e,t){var n=e.entities.images.byImageId[t];return n?n.duration:0}(n(),t.imageId),a=e(gn(Object(d.a)(Object(d.a)({},t),{},{duration:r})));e(An(a))})):l(Gn("You cannot drop an image directly, drop it into the image view first."));var t;r(null),u(0)}(t)}}function p(e){var t;(!n||e.timestamp-c>100&&Math.abs(e.x-n)>.01)&&(l((t=e.x,function(e,n){e(tn({markerId:"insertMarker",pos:t,type:"insert"}))})),r(e.x),u(e.timestamp))}return function(e,t){return f(e,t)}}function ta(){var e=Object(a.useState)(null),t=Object(je.a)(e,2),n=t[0],r=t[1],o=Object(s.c)();function i(e,t){switch(e){case"mouseDown":c(),function(e){e.markerId&&"timeScale"===e.markerType&&r(e.markerId)}(t);break;case"mouseUp":!function(e){if(n)r(null);else{var t={pos:e.x,type:"timeScale"};o(tn(t))}}(t),c();break;case"mouseMove":!function(e){var t=n?{pos:e.x,type:"timeScale",markerId:n}:{pos:e.x,type:"insertTimeScale",markerId:"insertTimeScaleId"};o(tn(t))}(t);break;case"mouseLeave":c()}}function c(){n||o(rn("insertTimeScaleId")),r(null)}return function(e,t){return i(e,t)}}function na(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=ta(),a=Qr(n),o=ea();function i(t,r){r.preventDefault();var a="keyDown"!==t?s(r,e,n):{},o=r.dataTransfer&&r.dataTransfer.getData("imageid"),i=r.dataTransfer&&Number(r.dataTransfer.getData("duration")),u=r.key,l=t;r.shiftKey&&(l="shift-"+l),r.ctrlKey&&(l="ctrl-"+l),c(l,Object(d.a)(Object(d.a)({},a),{},{timestamp:r.timeStamp,imageId:o,duration:i,key:u}))}function c(e,t){e.includes("drag")||e.includes("drop")?o(e,t):"PlaylistTimeScale"===t.className?r(e,t):a(e,t)}function s(e,n,r){for(var a=e.target,o=a.getAttribute("data-partid"),i=a.getAttribute("data-markerid"),c=a.getAttribute("data-markertype"),s=0,u=n;a&&a.classList&&!a.classList.contains(n);)a=a.parentNode;if(a&&a.classList&&a.classList.contains(n)){var l=a.parentNode?a.parentNode.scrollLeft:0;s=Math.max(0,e.clientX-a.offsetLeft+l)}else console.debug("Event did not find ".concat(n)),u=null;return{x:Mn(s,t),partId:o,markerId:i,markerType:c,channelId:r,className:u}}return function(e,t){return i(e,t)}}function ra(){var e=Object(Zt.a)(["\n  left: ","px;\n  position: absolute;\n"]);return ra=function(){return e},e}function aa(){var e=Object(Zt.a)(["\n  position: absolute;\n  width: ","px;\n  height: ","px;\n  left: 0;\n  right: 0;\n  bottom: 0;\n"]);return aa=function(){return e},e}function oa(){var e=Object(Zt.a)(["\n  position: absolute;\n  width: ","px;\n  height: 100%;\n"]);return oa=function(){return e},e}function ia(){var e=Object(Zt.a)(["\n  width: ","px;\n  position: relative;\n  left: 0;\n  right: 0;\n  height: 30px;\n  background: #2c387e;\n  color: white;\n  cursor: default\n"]);return ia=function(){return e},e}var ca={2e4:{marker:3e4,bigStep:1e4,smallStep:5e3,secondStep:5},12e3:{marker:15e3,bigStep:5e3,smallStep:1e3,secondStep:1},1e4:{marker:1e4,bigStep:5e3,smallStep:1e3,secondStep:1},5e3:{marker:5e3,bigStep:1e3,smallStep:500,secondStep:.5},2500:{marker:2e3,bigStep:1e3,smallStep:500,secondStep:.5},1500:{marker:2e3,bigStep:1e3,smallStep:200,secondStep:.2},700:{marker:1e3,bigStep:500,smallStep:100,secondStep:.1}};function sa(e){var t=e/1e3,n=t%60,r=(t-n)/60;return n<10&&(n="0".concat(n)),"".concat(r,":").concat(n)}var ua=Xt.a.div(ia(),(function(e){return e.cssWidth})),la=Xt.a.div(oa(),(function(e){return e.cssWidth})),da=Xt.a.canvas(aa(),(function(e){return e.cssWidth}),(function(e){return e.timeScaleHeight})),fa=Xt.a.div(ra(),(function(e){return e.pix}));function pa(e){var t=e.maxWidth,n=e.resolution,o=e.scale,i=e.timeScaleHeight,c=e.theme,s=Object(a.useRef)(null),u=function(e){var t=Object.keys(ca).map((function(e){return parseInt(e,10)}));t=t.sort((function(e,t){return e-t}));for(var n=0;n<t.length;n+=1)if(48e3/e<=t[n])return ca[t[n]];return ca[t[0]]}(n),l={},d=[],f=0;Object(a.useEffect)((function(){!function(){if(s){var e=s.current.getContext("2d");e.clearRect(0,0,s.width,s.height),e.fillStyle=c.timeColor,e.scale(o,o),Object.keys(l).forEach((function(t){var n=l[t],r=i-n;e.fillRect(t,r,1,n)}))}}()}));var p=na("PlaylistTimeScale",n);for(var h=0;h<t;h+=n*u.secondStep){var b=Math.floor(h);if(u.marker&&f%u.marker===0){var j=sa(f);d.push(Object(r.jsx)(fa,{pix:b,children:j},j)),l[b]=i}else u.bigStep&&f%u.bigStep===0?l[b]=Math.floor(i/2):u.smallStep&&f%u.smallStep===0&&(l[b]=Math.floor(i/5));f+=1e3*u.secondStep}return Object(r.jsxs)(ua,{className:"PlaylistTimeScale",onMouseDown:function(e){return p("mouseDown",e)},onMouseUp:function(e){return p("mouseUp",e)},onMouseMove:function(e){return p("mouseMove",e)},onMouseLeave:function(e){return p("mouseLeave",e)},cssWidth:t,children:[Object(r.jsxs)(la,{cssWidth:t,children:[d,Object(r.jsx)(da,{cssWidth:t,width:t*o,height:i*o,ref:s})]}),Object(r.jsx)($r,{className:"ChannelMarkersContainer",theme:c})]})}pa.defaultProps={scale:1,duration:0,samplesPerPixel:1e3,timeScaleHeight:10};var ha=Object(Xt.b)(pa);function ba(e){return function(t){Object(ot.a)(a,t);var n=Object(it.a)(a);function a(){return Object(rt.a)(this,a),n.apply(this,arguments)}return Object(at.a)(a,[{key:"render",value:function(){var t=this.props,n=t.resolution,a=t.offset,o=t.maxDuration,i=t.parts,c=Object(he.a)(t,["resolution","offset","maxDuration","parts"]),s=a?Nn(a,n):0,u=o?Nn(o,n):0,l=i?Object(ue.cloneDeep)(i):[];l.forEach((function(e){e.offset=e.offset?Nn(e.offset,n):0,e.duration=e.duration?Nn(e.duration,n):0}));var f=Object(d.a)(Object(d.a)({},c),{},{offset:s,maxWidth:u,parts:l,resolution:n});return Object(r.jsx)(e,Object(d.a)({},f))}}]),a}(a.PureComponent)}var ja=n(237),ma=n(235),ga=n.n(ma),va=n(236),Oa=n.n(va);function ya(){var e=Object(Zt.a)(["\n  float: left;\n  position: absolute;\n  left: ","px;\n  cursor: ",";\n  border-left: 1px solid ",";\n  border-right:  1px solid ",";\n"]);return ya=function(){return e},e}function xa(){var e=Object(Zt.a)(["\n  display: none;\n"]);return xa=function(){return e},e}function wa(){var e=Object(Zt.a)(["\n  float: left;\n  position: relative;\n  margin: 0;\n  padding: 0;\n  width: ","px;\n  height: ","px;\n"]);return wa=function(){return e},e}var ka=Xt.a.canvas(wa(),(function(e){return e.cssWidth}),(function(e){return e.height})),Ia=Xt.a.img(xa()),Ca=Xt.a.div(ya(),(function(e){return e.offset}),(function(e){return e.cursor}),(function(e){return e.theme.markerColor}),(function(e){return e.theme.markerColor})),Sa=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).widthFactor=1,r.canvaseRefs=[],r.imageRefs=[],r}return Object(at.a)(n,[{key:"componentDidMount",value:function(){this.draw()}},{key:"shouldComponentUpdate",value:function(e){var t=this,n=!1;return Object.entries(this.props).forEach((function(r){var a=Object(je.a)(r,2),o=a[0],i=a[1];"parts"===o?Oa()(e.parts,t.props.parts)||(n=!0):e[o]!==i&&(n=!0)})),n}},{key:"componentDidUpdate",value:function(e,t){this.draw()}},{key:"draw",value:function(){var e=this,t=this.props,n=t.imageHeight,r=t.scale;Object.keys(this.imageRefs).forEach((function(t){var a=e.imageRefs[t],o=0;if(a)for(var i=0;i<e.canvaseRefs[t].length;i++){var c=e.canvaseRefs[t][i];if(!c)break;var s=c.getContext("2d");s.clearRect(0,0,c.width,c.height);var u=o/e.widthFactor[t];s.scale(r,r),a.src?a.onload=s.drawImage(a,u,0,a.width,a.height,0,0,a.width*e.widthFactor[t],n):(s.fillStyle="#FF0000",s.fillRect(0,0,c.width,n)),o+=1e3}}))}},{key:"createCanvasRef",value:function(e,t){var n=this;return function(r){n.canvaseRefs[e]||(n.canvaseRefs[e]=[]),n.canvaseRefs[e][t]=r}}},{key:"createImageRef",value:function(e){var t=this;return function(n){t.imageRefs[e]=n}}},{key:"render",value:function(){var e=this,t=this.props,n=t.parts,o=t.imageHeight,i=t.scale,c=t.theme,s=t.images,u=[],l=[];return this.canvaseRefs=[],this.imageRefs=[],this.widthFactor=[],n&&Array.isArray(n)&&n.forEach((function(t){var n=Object(d.a)({},t),a=n.partId,f=n.imageId,p=n.offset,h=n.duration,b=s[f].src;e.widthFactor[a]=h/s[f].width;for(var j=[],m=h,g=0;m>0;){var v=Math.min(m,1e3),O=Object(r.jsx)(ka,{cssWidth:v,width:v*i,height:o+2,ref:e.createCanvasRef(a,g),"data-partid":a,theme:c},String(a)+"-"+String(g));j.push(O),m-=v,g+=1}u.push(Object(r.jsx)(Ca,{className:"ImageCanvases",theme:c,offset:p,cursor:"move",children:j},a)),l.push(Object(r.jsx)(Ia,{src:b,className:"hidden",ref:e.createImageRef(a)},a))})),Object(r.jsxs)(a.Fragment,{children:[l,u]})}}]),n}(a.Component);Sa.defaultProps={scale:1,offset:0,maxWidth:800,imageHeight:90};var Ea=Object(Xt.b)(Sa);function Aa(){var e=Object(Zt.a)(["\n  float: left;\n  position: relative;\n  left: ","px;\n  background: ",";\n"]);return Aa=function(){return e},e}function Ra(){var e=Object(Zt.a)(["\n  float: left;\n  position: relative;\n  margin: 0;\n  padding: 0;\n  width: ","px;\n  height: ","px;\n"]);return Ra=function(){return e},e}var Da=Xt.a.canvas(Ra(),(function(e){return e.cssWidth}),(function(e){return e.waveHeight})),Pa=Xt.a.div(Aa(),(function(e){return e.offset}),(function(e){return e.theme.waveFillColor})),Ma=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).canvases=[],r}return Object(at.a)(n,[{key:"componentDidMount",value:function(){this.draw()}},{key:"componentDidUpdate",value:function(e,t){this.draw()}},{key:"draw",value:function(){for(var e=this.props,t=e.peaks,n=e.bits,r=e.waveHeight,a=e.theme,o=e.scale,i=0,c=0;c<this.canvases.length;c++){var s=this.canvases[c];if(!s)break;var u=s.getContext("2d"),l=r/2,d=Math.pow(2,n-1);u.clearRect(0,0,s.width,s.height),u.fillStyle=a.waveOutlineColor,u.scale(o,o);for(var f=s.width/o,p=0;p<f;p+=1){var h=t[2*(p+i)]/d,b=t[2*(p+i)+1]/d,j=Math.abs(h*l),m=Math.abs(b*l);u.fillRect(p,0,1,l-m),u.fillRect(p,l+j,1,l-j)}i+=1e3}}},{key:"createCanvasRef",value:function(e){var t=this;return function(n){t.canvases[e]=n}}},{key:"render",value:function(){for(var e=this.props,t=e.maxWidth,n=e.waveHeight,o=e.scale,i=e.theme,c=e.offset,s=t,u=0,l=[];s>0;){var d=Math.min(s,1e3),f=Object(r.jsx)(Da,{cssWidth:d,width:d*o,height:n*o,waveHeight:n,ref:this.createCanvasRef(u)},"".concat(t,"-").concat(u));l.push(f),s-=d,u+=1}return Object(r.jsx)(a.Fragment,{children:Object(r.jsx)(Pa,{className:"WaveformCanvases",theme:i,offset:c,children:l})})}}]),n}(a.PureComponent);Ma.defaultProps={scale:1,offset:0,maxWidth:0,peaks:[],bits:0,waveHeight:92};var Na=Object(Xt.b)(Ma);function Ta(){var e=Object(Zt.a)(["\n  position: relative; \n  margin: 0;\n  padding: 0;\n  background: ",";\n  width: ","px;\n  height: ","px;\n  border: 1px solid ",";\n  border-left: none;\n"]);return Ta=function(){return e},e}var La=Xt.a.div(Ta(),(function(e){return e.backgroundColor}),(function(e){return e.cssWidth}),(function(e){return e.height}),(function(e){return e.theme.borderColor}));function _a(e){var t=e.channelId,n=e.imageHeight,o=e.progress,i=e.theme,c=e.maxWidth,s=e.selected,u=e.type,l=e.offset,f=e.peaks,p=e.bits,h=e.parts,b=e.images,j=na("ChannelWrapper",e.resolution,t);Object(a.useEffect)((function(){return document.addEventListener("keydown",(function(e){return j("keyDown",e)})),function(){return document.removeEventListener("keydown",(function(e){return function(e){return j("keyDown",e)}}))}}));var m={cssWidth:c+2,theme:i,height:n+2,tabIndex:0,backgroundColor:s?i.imageBackgroundColorSelected:i.imageBackgroundColor},g="audio"===u?{theme:i,maxWidth:c,offset:l,peaks:f,bits:p}:{theme:i,maxWidth:c,selected:s,parts:h,images:b},v="audio"===u?Object(r.jsx)(Na,Object(d.a)({},g)):Object(r.jsx)(Ea,Object(d.a)({},g));return Object(r.jsxs)(La,Object(d.a)(Object(d.a)({},m),{},{className:"ChannelWrapper",onMouseDown:function(e){return j("mouseDown",e)},onMouseUp:function(e){return j("mouseUp",e)},onMouseMove:function(e){return j("mouseMove",e)},onMouseLeave:function(e){return j("mouseLeave",e)},onDragEnter:function(e){return j("dragEnter",e)},onDragEnd:function(e){return j("dragEnd",e)},onDragExit:function(e){return j("dragExit",e)},onDragLeave:function(e){return j("dragLeave",e)},onDragOver:function(e){return j("dragOver",e)},onDragStart:function(e){return j("dragStart",e)},onDrop:function(e){return j("drop",e)},children:[v,Object(r.jsx)($r,{className:"ChannelMarkersContainer",channelId:t,progress:o,theme:i})]}))}_a.defaultProps={maxWidth:800,imageHeight:90};var Wa=Object(Xt.b)(_a),Fa=n(63),Ga=function(){function e(t,n){Object(rt.a)(this,e),this.ac=t,this.gain=1,this.buffer=n,this.destination=this.ac.destination}return Object(at.a)(e,[{key:"applyFade",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"logarithmic";if(e===Fa.FADEIN)Object(Fa.createFadeIn)(this.fadeGain.gain,r,t,n);else{if(e!==Fa.FADEOUT)throw new Error("Unsupported fade type");Object(Fa.createFadeOut)(this.fadeGain.gain,r,t,n)}}},{key:"applyFadeIn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"logarithmic";this.applyFade(Fa.FADEIN,e,t,n)}},{key:"applyFadeOut",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"logarithmic";this.applyFade(Fa.FADEOUT,e,t,n)}},{key:"isPlaying",value:function(){return void 0!==this.source}},{key:"getDuration",value:function(){return this.buffer.duration}},{key:"setAudioContext",value:function(e){this.ac=e,this.destination=this.ac.destination}},{key:"setUpSource",value:function(){var e=this;this.source=this.ac.createBufferSource(),this.source.buffer=this.buffer;var t=new Promise((function(t){e.source.onended=function(){e.source.disconnect(),e.fadeGain.disconnect(),e.volumeGain.disconnect(),e.shouldPlayGain.disconnect(),e.masterGain.disconnect(),e.source=void 0,e.fadeGain=void 0,e.volumeGain=void 0,e.shouldPlayGain=void 0,e.masterGain=void 0,t()}}));return this.fadeGain=this.ac.createGain(),this.volumeGain=this.ac.createGain(),this.shouldPlayGain=this.ac.createGain(),this.masterGain=this.ac.createGain(),this.source.connect(this.fadeGain),this.fadeGain.connect(this.volumeGain),this.volumeGain.connect(this.shouldPlayGain),this.shouldPlayGain.connect(this.masterGain),this.masterGain.connect(this.destination),t}},{key:"setVolumeGainLevel",value:function(e){this.volumeGain&&(this.volumeGain.gain.value=e)}},{key:"setShouldPlay",value:function(e){this.shouldPlayGain&&(this.shouldPlayGain.gain.value=e?1:0)}},{key:"setMasterGainLevel",value:function(e){this.masterGain&&(this.masterGain.gain.value=e)}},{key:"play",value:function(e,t,n){this.source.start(e,t,n)}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.source&&this.source.stop(e)}}]),e}();function Ua(e){var t=function(t){Object(ot.a)(a,t);var n=Object(it.a)(a);function a(e){var t;return Object(rt.a)(this,a),(t=n.call(this,e)).startPlay=function(e,n,r){if(!t.playout&&t.audioContext&&(t.playout=new Ga(t.audioContext,t.props.buffer)),!t.isPlaying()&&n>=e){var a=r||0,o=Math.max(0,e),i=t.props.buffer?t.props.buffer.duration:t.props.maxDuration,c=n-e<.1?i+a:n,s=o-a<0?0:o-a,u=e-a<0?a-e:0,l=c-a;if(t.animateStartAt=o,t.animateEndAt=n-e<.1?t.props.maxDuration+a:l+a,l>0&&t.playout){console.log("playing ".concat(t.props.type," from ").concat(s,"s( ").concat(o,"s) ")+"to ".concat(l,"(").concat(c,"s) with delay ").concat(u,", offset: ").concat(a,", ")+"delay ".concat(u)),t.playout.setUpSource().then(t.stopPlay);var d=c-o;t.playout.play(t.audioContext.currentTime+u,s,d)}t.animationRequest=window.requestAnimationFrame(t.animateProgress)}},t.animateProgress=function(e){t.animationStartTime||(t.animationStartTime=e);var n=e-t.animationStartTime,r=t.animateStartAt+n/1e3;t.setState(Object(d.a)(Object(d.a)({},t.state),{},{progress:r})),t.props.reportProgress&&t.props.reportProgress(r),r<t.animateEndAt?t.animationRequest=window.requestAnimationFrame(t.animateProgress):t.stopPlay()},t.stopAnimateProgress=function(){window.cancelAnimationFrame(t.animationRequest),t.setState(Object(d.a)(Object(d.a)({},t.state),{},{progress:null})),t.animationStartTime=null},t.isPlaying=function(){return null!==t.animationStartTime},t.stopPlay=function(){t.playout&&t.playout.stop(),t.stopAnimateProgress(),t.props.stopChannel(t.props.channelId)},t.animationStartTime=null,t.playStartAt=0,t.playEndAt=0,t.state={progress:null},t}return Object(at.a)(a,[{key:"componentDidMount",value:function(){"audio"===this.props.type&&(this.playout=null,window.AudioContext=window.AudioContext||window.webkitAudioContext,this.audioContext=new window.AudioContext)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,r=n.playState,a=n.selection,o=n.offset;e.playState!==r&&("playing"===r?this.startPlay(a.from,a.to,o):this.isPlaying()&&this.stopPlay())}},{key:"componentWillUnmount",value:function(){this.isPlaying()&&this.stopPlay()}},{key:"render",value:function(){return Object(r.jsx)(e,Object(d.a)(Object(d.a)({},this.props),{},{progress:this.state.progress}))}}]),a}(a.PureComponent);return Ua.displayName="WithPlay(".concat(function(e){return e.displayName||e.name||"Component"}(e),")"),t}var Ba=Ua(ba(Wa)),Ha=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).doExtractPeaks=Object(ja.a)((function(e,t,n){return ga()(e,t,!0,0,e.length,n)})),r.state={error:null},r}return Object(at.a)(n,null,[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),Object(at.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"render",value:function(){if(this.state.error)return Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:" ERROR! Cannot continue. "}),this.state.error.message?Object(r.jsx)("p",{children:this.state.error.message}):null,this.state.error.stack?Object(r.jsx)("p",{children:this.state.error.stack}):null]});var e=this.props,t=e.buffer,n=e.sampleRate,a=e.resolution,o=t?this.doExtractPeaks(t,n/a,16):{data:[],length:0,bits:0},i=o.data,c=o.duration,s=o.bits,u=Array.isArray(i)?i[0]:[],l=Object(d.a)(Object(d.a)({},this.props),{},{peaks:u,bits:s,duration:c});return Object(r.jsx)(Ba,Object(d.a)({},l))}}]),n}(a.Component),za=Object(s.b)((function(e,t){var n=t.channelId,r=t.images,a=function(e,t){var n=Te(e,t),r=n.type,a=n.sampleRate,o=n.duration,i=n.parts,c=n.buffer;return Object(he.a)(n,["type","sampleRate","duration","parts","buffer"]),{channelId:t,type:r,active:Pe(e,t),sampleRate:a,duration:o,parts:i,selected:re(e)===t,buffer:c}}(e,n),o=Ie(e,a.parts);return Object(d.a)(Object(d.a)({},a),{},{parts:o,images:r})}),(function(e){return{stopChannel:function(t){return e(function(e){return{type:v,payload:e}}(t))}}}))(Ha);function Va(){var e=Object(Zt.a)(["\n  margin: 20px;\n  width: 100%;\n"]);return Va=function(){return e},e}function Ka(){var e=Object(Zt.a)(["\n  width:  calc(95vw - ","px);\n  transition: width .1s;\n\toverflow: auto;\n\twhite-space: nowrap;\n"]);return Ka=function(){return e},e}var Ja=Xt.a.div(Ka(),(function(e){return e.drawerWidth})),Ya=Object(Xt.a)(Gr.a)(Va()),qa=ba(ha),Za=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).considerScroll=function(){"playing"===r.props.playState&&r.groupRef&&(Math.abs(r.state.scrollLeft-r.groupRef.scrollLeft)>10&&(r.groupRef.scrollLeft=r.state.scrollLeft))},r.reportProgress=function(e){var t=Nn(e,r.props.resolution);(t>r.groupRef.scrollLeft+r.groupRef.clientWidth||t<r.groupRef.scrollLeft)&&r.setState({scrollLeft:t})},r.groupRef=null,r.state={scrollLeft:0},r}return Object(at.a)(n,[{key:"componentDidUpdate",value:function(){this.considerScroll()}},{key:"render",value:function(){var e=this,t=this.props,n=t.allchannelIds,o=Object(he.a)(t,["allchannelIds"]),i=n.map((function(t){return Object(a.createElement)(za,Object(d.a)(Object(d.a)({},o),{},{className:"ChannelContainer",channelId:t,key:t,reportProgress:e.reportProgress}))}));return Object(r.jsxs)(Ja,{className:"ChannelGroupWrapper",drawerWidth:this.props.drawerWidth||0,ref:function(t){return e.groupRef=t},children:[Object(r.jsx)(qa,{className:"TimeScaleInSecs",maxDuration:this.props.maxDuration,resolution:this.props.resolution,theme:this.props.theme}),i,this.props.isLoadingShow&&Object(r.jsx)(Ya,{disableShrink:!0})]})}}]),n}(a.Component),Xa={waveOutlineColor:"#282c34",waveFillColor:"#05a0cd",waveProgressColor:"transparent",waveProgressBorderColor:"rgb(255,255,255)",markerColor:"rgba(255,255, 0, 0.5)",markerColorOther:"rgba(255,255, 0, 0.2)",insertMarkerColor:"rgba(255,165, 0, 0.5)",selectedMarkerColor:"rgba(255,165, 0, 1)",selectedMarkerColorOther:"rgba(255,165, 0, 0.3)",selectionColor:"rgba(200,200,255,0.5)",tempSelectionColor:"rgba(80,80,80,0.5)",imageBackgroundColor:"black",imageBackgroundColorSelected:"#101010",borderColor:"#3f51b5",timeColor:"grey"},$a=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).state={error:null},r}return Object(at.a)(n,null,[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),Object(at.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e})}},{key:"render",value:function(){if(this.state.error)return Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:" ERROR! Cannot continue. "}),this.state.error.message?Object(r.jsxs)("p",{children:[this.state.error.message," "]}):null,this.state.error.stack?Object(r.jsxs)("p",{children:[this.state.error.stack," "]}):null]});var e=Object(d.a)(Object(d.a)({},this.props),{},{theme:Xa});return Object(r.jsx)(Za,Object(d.a)({},e))}}]),n}(a.Component),Qa=Object(s.b)((function(e,t){return{allchannelIds:Re(e),maxDuration:We(e),images:de(e),playState:Me(e)?"stopped":"playing",isLoadingShow:ie(e),resolution:ne(e),selection:te(e)}}),(function(e){return{setMessage:function(t,n,r){return e(Gn({text:t,type:n,title:r}))}}}))($a);function eo(){var e=Object(Zt.a)(["\n\toverflow: auto;\n\tflex-wrap: wrap;\n"]);return eo=function(){return e},e}function to(){var e=Object(Zt.a)(["\n\twidth:  calc(95vw - ","px);\n\toverflow: auto;\n"]);return to=function(){return e},e}var no=Xt.a.div(to(),(function(e){return e.drawerWidth})),ro=Xt.a.canvas(eo()),ao=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).state={dragging:!1},r}return Object(at.a)(n,[{key:"render",value:function(){return Object(r.jsx)(no,{drawerWidth:this.props.drawerWidth,children:Object(r.jsx)(ro,{id:"imageExportCanvas"})})}}]),n}(a.PureComponent),oo=n(470);function io(){var e=Object(Zt.a)(["\n"]);return io=function(){return e},e}function co(){var e=Object(Zt.a)(["\n\tcolor: white\n"]);return co=function(){return e},e}function so(){var e=Object(Zt.a)(["\n\twidth:  96px;\n\tbackground-color: #2c387e;\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-around;\n\talign-items: flex-end;\n\tpadding: 20px;\n\tcolor: #3f51b5;\n\tfont-weight: 600;\n"]);return so=function(){return e},e}function uo(){var e=Object(Zt.a)(["\n\twidth:  calc(95vw - ","px);\n\tbackground-color: black;\n\tdisplay: flex;\n\tflex-direction: row;\n"]);return uo=function(){return e},e}function lo(){var e=Object(Zt.a)(["\n  .MuiSlider-track {\n    background-color: white;\n  }\n  .MuiSlider-thumbWrapper {\n    button {\n      background-color: white;\n    }\n  }\n"]);return lo=function(){return e},e}var fo=.1,po=Object(Xt.a)(oo.a)(lo()),ho=Xt.a.div(uo(),(function(e){return e.drawerWidth})),bo=Xt.a.div(so()),jo=Object(Xt.a)(ht.a)(co()),mo=Xt.a.canvas(io()),go=Ua(function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).handleChange=function(e,t){var n=r.slider2speed(t);r.setState({rotationSpeed:n})},r.prevRad=0,r.prevTime=0,r.innerRadius=2,r.margin=10,r.state={rotationSpeed:2},r}return Object(at.a)(n,[{key:"componentDidMount",value:function(){this.draw()}},{key:"componentDidUpdate",value:function(e){var t=this.props.progress&&!e.progress;this.draw(t)}},{key:"drawArc",value:function(e,t,n,r,a,o){var i=this.props.resolution,c=i*(30+this.innerRadius),s=this.margin+c+t*(this.margin+2*c),u=this.margin+c;e.beginPath(),e.arc(s,u,i*r,a,o,!1),e.strokeStyle=n,e.lineWidth=2,e.stroke()}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props,n=t.progress,r=t.sampleRate,a=t.activeChannels;if(n&&n>0){var o=pr(this.prevTime,n,r),i=document.getElementById("animationPaneCanvas"),c=i.getContext("2d");e&&(c.fillStyle="black",c.fillRect(0,0,i.width,i.height));for(var s=Tn(1,r,this.state.rotationSpeed),u=o.data,l=a.length,d=0;d<o.width;d++){for(var f=this.prevRad+s,p=0;p<30;p++)for(var h=0;h<l;h++){var b=30*h+p,j=b*o.width+d,m=4*j,g="rgba(".concat(u[m],",").concat(u[m+1],",").concat(u[m+2],",255)");this.drawArc(c,h,g,p+this.innerRadius,this.prevRad,f)}this.prevRad=f}this.prevTime=n}}},{key:"speed2slider",value:function(e){return(e-fo)/9.8*100}},{key:"slider2speed",value:function(e){return fo+e/100*9.8}},{key:"render",value:function(){var e=this.state.rotationSpeed,t=this.props,n=t.drawerWidth,a=t.activeChannels,o=t.resolution;return Object(r.jsxs)(ho,{drawerWidth:n,children:[Object(r.jsxs)(bo,{children:[Object(r.jsxs)(jo,{children:[" ",e.toFixed(1)]}),Object(r.jsx)(po,{value:this.speed2slider(e),onChange:this.handleChange,orientation:"vertical",style:{width:0}})]}),Object(r.jsx)(mo,{id:"animationPaneCanvas",height:80*o,width:a.length*o*80})]})}}]),n}(a.PureComponent)),vo=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).playState="stopped",r}return Object(at.a)(n,[{key:"stopChannel",value:function(e){}},{key:"render",value:function(){return Object(r.jsx)(go,Object(d.a)({sampleRate:100,resolution:2,type:"animation",stopChannel:this.stopChannel,channelId:"none"},this.props))}}]),n}(a.Component),Oo=Object(s.b)((function(e){return{playState:Me(e)?"stopped":"playing",activeChannels:Ne(e,"image"),selection:te(e),maxDuration:We(e)}}),(function(e){return{}}))(vo),yo=n(461),xo=n(238),wo=n(457),ko=n(459),Io=n(456),Co=n.n(Io),So=n(458),Eo=n.n(So);function Ao(){var e=Object(Zt.a)(["\n  .MuiSlider-track {\n    background-color: white;\n  }\n  .MuiSlider-thumbWrapper {\n    button {\n      background-color: white;\n    }\n  }\n"]);return Ao=function(){return e},e}var Ro=Object(Xt.a)(oo.a)(Ao());var Do=Object(ut.a)((function(){return{channelSelectorWrapper:{display:"flex",justifyContent:"space-between",flexDirection:"row",padding:"12px",height:"92px",width:"".concat(96,"px"),border:"1px #3949ab solid",borderRight:"none"},wrapperInActive:{background:"#212121"},wrapperSelected:{backgroundColor:"#3f51b5"},sliderWrapper:{display:"flex",justifyContent:"flex-end",padding:"4px"},icon:{fill:"white",width:".8em"},button:{padding:0,margin:0},button1:{paddingRight:"8px"},actionsWrapper:{width:"100%",paddingRight:"8px",display:"flex",flexDirection:"column",justifyContent:"flex-end"},actionsRow:{display:"flex",flexDirection:"row",justifyContent:"flex-end"},actionsRow2:{padding:"8px 0 2px 0"}}}))((function(e){var t=e.classes,n=e.channelId,a=e.selected,o=e.active,i=e.gain,c=e.type,s=er()(),u="image"===c;return Object(r.jsxs)("div",{className:st()(t.channelSelectorWrapper,a&&o&&t.wrapperSelected,!o&&t.wrapperInActive),background:xo.indigo,children:[Object(r.jsxs)("div",{className:t.actionsWrapper,children:[Object(r.jsxs)("div",{className:t.actionsRow,children:[u&&Object(r.jsx)(wt.a,{title:"Upload channel to poi",children:Object(r.jsx)(jt.a,{className:st()(t.button,t.button1),disabled:!s,onClick:function(){return e.uploadImageChannelToPoi(n)},children:Object(r.jsx)(Co.a,{className:t.icon})})}),u&&Object(r.jsx)(wt.a,{title:"Save channel as binary",children:Object(r.jsx)(jt.a,{className:t.button,onClick:function(){return e.saveImageChannelAsBinary(n)},children:Object(r.jsx)(wo.a,{className:t.icon})})})]}),Object(r.jsxs)("div",{className:st()(t.actionsRow,t.actionsRow2),children:[u&&Object(r.jsx)(wt.a,{title:"Duplicate channel",children:Object(r.jsx)(jt.a,{className:st()(t.button,t.button1),onClick:function(){return e.duplicateChannel(n)},children:Object(r.jsx)(Eo.a,{className:t.icon})})}),Object(r.jsx)(wt.a,{title:"Delete channel",children:Object(r.jsx)(jt.a,{className:t.button,onClick:function(){return e.deleteChannel(n)},children:Object(r.jsx)(ko.a,{className:t.icon})})})]})]}),Object(r.jsx)("div",{className:t.sliderWrapper,children:Object(r.jsx)(wt.a,{title:0===i?"channel off":"gain: ".concat(i.toPrecision(2)),children:Object(r.jsx)(Ro,{orientation:"vertical",className:t.slider,value:i,onChange:function(t,n){return function(r,a){e.updateChannel({channelId:t,gain:a}),0===a&&n?e.setChannelInactive(t):a>0&&!n&&e.setChannelActive(t)}}(n,o),min:0,max:1,step:.05})})})]},n)})),Po=n(460),Mo=n.n(Po);var No=Object(ut.a)((function(){return{snapWrapper:{height:"30px",width:"".concat(96,"px"),display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",border:"1px #3949ab solid",borderRight:"none"},snapButton:{color:function(e){return e.snapToMarkers?"red":"white"}},snapIcon:{width:".6em"},checked:{}}}))((function(e){var t=e.classes,n=e.snapToMarkers,a="Snap to markers: ".concat(n?"on":"off");return Object(r.jsx)("div",{className:t.snapWrapper,children:Object(r.jsx)(wt.a,{title:a,children:Object(r.jsx)(jt.a,{props:{snapToMarkers:n},className:t.snapButton,onClick:e.toggleSnapToMarkers,children:Object(r.jsx)(Mo.a,{className:t.snapIcon})})})})}));var To=Object(ut.a)((function(){return{formGroup:{background:"#2c387e"}}}))((function(e){var t=e.classes,n=(e.channelIds,Object(he.a)(e,["classes","channelIds"])),a=e.channelIds.map((function(t){var a=Object(d.a)(Object(d.a)(Object(d.a)({},n),e.getChannelSelectorData(t)),{},{key:t});return Object(r.jsx)(Do,Object(d.a)({},a))}));return Object(r.jsxs)(yo.a,{className:t.formGroup,children:[e.channelIds&&e.channelIds.length>0&&Object(r.jsx)(No,{snapToMarkers:e.snapToMarkers,toggleSnapToMarkers:e.toggleSnapToMarkers}),a]})})),Lo=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(){return Object(rt.a)(this,n),t.apply(this,arguments)}return Object(at.a)(n,[{key:"render",value:function(){return Object(r.jsx)(To,Object(d.a)({},this.props))}}]),n}(a.Component),_o=Object(s.b)((function(e,t){return{channelIds:Re(e),snapToMarkers:ce(e),getChannelSelectorData:function(t){return function(e,t){var n=Te(e,t),r=n.type,a=n.gain;return Object(he.a)(n,["type","gain"]),{channelId:t,type:r,gain:a,active:Pe(e,t),selected:re(e)===t}}(e,t)}}}),(function(e){return{updateChannel:function(t){return e(gr(t))},setChannelActive:function(t){return e(vr(t))},setChannelInactive:function(t){return e(Or(t))},uploadImageChannelToPoi:function(t){return e(function(e){return function(t,r){t(lr(1)),t(dr(e,0,!0));var a=pr();er()()&&n(112).uploadChannel(or(a),(function(e){console.log(e),t(Fn(e))}))}}(t))},saveImageChannelAsBinary:function(t){return e(fr(t))},deleteChannel:function(t){return e(mr(t))},duplicateChannel:function(t){return e(function(e){return function(t,n){var r=Ge(n(),e);t(jr(r))}}(t))},toggleSnapToMarkers:function(t){return e({type:Q})}}}))(Lo),Wo=n(53),Fo=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(){return Object(rt.a)(this,n),t.apply(this,arguments)}return Object(at.a)(n,[{key:"render",value:function(){return Object(r.jsx)(Wo.a,Object(d.a)({},this.props))}}]),n}(a.Component),Go=Object(s.b)((function(e,t){return{uploadLog:ae(e)}}),(function(e){return{clearUploadLog:function(){return e({type:Z})},cancelUpload:function(){return e((function(e,t){er()()&&n(112).killCurrentProcess()}))}}}))(Fo),Uo=n(418),Bo=n(244),Ho=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(){var e;Object(rt.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).handleClose=function(){return e.props.clearMessage()},e}return Object(at.a)(n,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.classes,a=t&&t.title?t.title:"Message",o=t&&t.text?Object(r.jsx)(ht.a,{className:n.text,children:t.text}):null;return Object(r.jsx)(Uo.a,{open:Boolean(t),"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",disableBackdropClick:!0,onClose:this.handleClose,children:Object(r.jsxs)("div",{className:n.paper,children:[Object(r.jsx)("div",{className:n.headingArea,children:Object(r.jsx)(ht.a,{variant:"h6",id:"modal-title",children:a})}),Object(r.jsx)("div",{className:n.textArea,children:Object(r.jsx)("div",{variant:"body2",id:"simple-modal-description",children:o})}),Object(r.jsx)("div",{className:n.buttonArea,children:Object(r.jsx)(Bo.a,{onClick:this.handleClose,children:"OK"})})]})})}}]),n}(a.Component),zo=Object(ut.a)((function(e){return{paper:{position:"absolute",backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(4),outline:"none",top:"20%",left:"20%",display:"flex",flexDirection:"column"},headingArea:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:e.spacing(2)},textArea:{marginBottom:e.spacing(2),height:"100%",overflow:"auto"},text:{fontSize:"14px",lineHeight:"normal",wordBreak:"break-all"},buttonArea:{alignSelf:"flex-end"}}}),{withTheme:!0})(Ho),Vo=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(){return Object(rt.a)(this,n),t.apply(this,arguments)}return Object(at.a)(n,[{key:"render",value:function(){return Object(r.jsx)(zo,Object(d.a)({},this.props))}}]),n}(a.Component),Ko=Object(s.b)((function(e,t){return{message:oe(e)}}),(function(e){return{clearMessage:function(){return e({type:$})}}}))(Vo),Jo=400,Yo=function(e){Object(ot.a)(n,e);var t=Object(it.a)(n);function n(e){var r;return Object(rt.a)(this,n),(r=t.call(this,e)).handleDrawerOpen=function(){r.setState(Object(d.a)(Object(d.a)({},r.state),{},{open:!0}))},r.handleDrawerClose=function(){r.setState(Object(d.a)(Object(d.a)({},r.state),{},{open:!1}))},r.state={error:null,open:!1},r}return Object(at.a)(n,null,[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),Object(at.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState(Object(d.a)(Object(d.a)({},this.state),{},{error:e}))}},{key:"render",value:function(){if(this.state.error)return Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:" ERROR! Cannot continue. "}),this.state.error.message?Object(r.jsxs)("p",{children:[" ",this.state.error.message," "]}):null,this.state.error.stack?Object(r.jsxs)("p",{children:[" ",this.state.error.stack," "]}):null]});var e=this.props,t=e.classes,n=e.theme,a=this.state.open;return Object(r.jsxs)("div",{className:t.root,children:[Object(r.jsx)(pt.a,{}),Object(r.jsx)(dt.a,{position:"fixed",className:st()(t.appBar,{[t.appBarShift]:a}),children:Object(r.jsxs)(ft.a,{disableGutters:!a,children:[Object(r.jsxs)("div",{className:t.title,children:[Object(r.jsx)(ht.a,{variant:"h6",className:t.title1,children:"L"}),Object(r.jsx)(ht.a,{variant:"h6",className:t.title2,children:"u"}),Object(r.jsx)(ht.a,{variant:"h6",className:t.title3,children:"m"}),Object(r.jsx)(ht.a,{variant:"h6",className:t.title4,children:"i"}),Object(r.jsx)(ht.a,{variant:"h6",className:t.title5,children:"n"}),Object(r.jsx)(ht.a,{variant:"h6",className:t.title6,children:"o"}),Object(r.jsx)(ht.a,{variant:"h6",className:t.title7,children:"s"}),Object(r.jsx)(ht.a,{variant:"h6",className:t.title8,children:"i"}),Object(r.jsx)(ht.a,{variant:"h6",className:t.title9,children:"a"})]}),Object(r.jsx)(Ir,{}),Object(r.jsx)("div",{className:t.grow}),Object(r.jsx)(wt.a,{title:"Work with images",children:Object(r.jsx)(jt.a,{color:"inherit","aria-label":"Open drawer",onClick:this.handleDrawerOpen,className:st()(t.menuButton,a&&t.hide),children:Object(r.jsx)(gt.a,{})})})]})}),Object(r.jsxs)("main",{className:st()(t.content,{[t.contentShift]:a}),children:[Object(r.jsx)("div",{className:t.drawerHeader}),Object(r.jsx)(Ko,{}),Object(r.jsx)(Go,{}),Object(r.jsx)(Oo,{drawerWidth:a?Jo:0}),Object(r.jsxs)("div",{className:t.channelPane,children:[Object(r.jsx)(_o,{}),Object(r.jsx)(Qa,{drawerWidth:a?496:96,width:96})]}),Object(r.jsx)(ao,{drawerWidth:a?Jo:0})]}),Object(r.jsxs)(lt.a,{className:t.drawer,variant:"persistent",anchor:"right",open:a,classes:{paper:t.drawerPaper},children:[Object(r.jsxs)("div",{className:t.drawerHeader,children:[Object(r.jsx)(jt.a,{onClick:this.handleDrawerClose,children:"rtl"===n.direction?Object(r.jsx)(Ot.a,{}):Object(r.jsx)(xt.a,{})}),Object(r.jsx)(Fr,{})]}),Object(r.jsx)(bt.a,{}),Object(r.jsx)($n,{}),Object(r.jsx)(bt.a,{})]})]})}}]),n}(o.a.Component),qo=Object(ut.a)((function(e){return{root:{display:"flex",flexGrow:1},grow:{flexGrow:1},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(Jo,"px)"),transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:Jo},title:{display:"flex",flexDirection:"row",paddingLeft:20,minWidth:"6em"},title1:{color:"#f44336"},title2:{color:"#ffc107"},title3:{color:"#e91e63"},title4:{color:"#8bc34a"},title5:{color:"#00bcd4"},title6:{color:"#8bc34a"},title7:{color:"#af52bf"},title8:{color:"#d7e360"},title9:{color:"#ffc107"},menuButton:{marginLeft:12,marginRight:20},hide:{display:"none"},drawer:{width:Jo,flexShrink:0},drawerPaper:{width:Jo},drawerHeader:Object(d.a)(Object(d.a)({display:"flex",alignItems:"center",padding:"0 8px"},e.mixins.toolbar),{},{justifyContent:"space-between"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginRight:-400},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0},channelPane:{display:"flex",flexDirection:"row"}}}),{withTheme:!0})(Yo);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(r.jsx)(s.a,{store:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(u.e)(tt,e,nt(Object(u.a)(l.a)))}(),children:Object(r.jsx)(qo,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},53:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return j}));var r=n(9),a=n(7),o=n(11),i=n(10),c=n(1),s=n(0),u=n(8),l=n(243),d=n(418),f=n(416),p=n(244),h="Upload completed.",b="Unable to complete upload.",j="Upload cancelled.",m=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).handleClose=function(){return e.props.clearUploadLog()},e.handleCancel=function(){return e.props.cancelUpload()},e}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props,t=e.uploadLog,n=e.classes,r=t?t.split("\n"):[],a=0,o=r.map((function(e){return Object(c.jsx)(l.a,{className:n.text,children:e},a++)})),i=t&&(t.includes(h)||t.includes(b)||t.includes(j));return Object(c.jsx)(d.a,{open:Boolean(t),"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",disableBackdropClick:!0,onClose:this.handleClose,children:Object(c.jsxs)("div",{className:n.paper,children:[Object(c.jsxs)("div",{className:n.headingArea,children:[Object(c.jsx)(l.a,{variant:"h6",id:"modal-title",children:"Poi upload"}),i?null:Object(c.jsx)(f.a,{className:n.progress})]}),Object(c.jsx)("div",{className:n.textArea,children:Object(c.jsx)("div",{variant:"body2",id:"simple-modal-description",children:o})}),Object(c.jsxs)("div",{className:n.buttonArea,children:[Object(c.jsx)(p.a,{disabled:i,onClick:this.handleCancel,children:"Cancel upload"}),Object(c.jsx)(p.a,{disabled:!i,onClick:this.handleClose,children:"Close"})]})]})})}}]),n}(s.Component);t.a=Object(u.a)((function(e){return{paper:{position:"absolute",backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(4),outline:"none",top:"20%",left:"20%",width:"60%",height:"70vh",display:"flex",flexDirection:"column"},headingArea:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginRight:"20px",marginBottom:"10px"},textArea:{display:"flex",flexDirection:"column-reverse",height:"100%",overflowX:"none",overflowY:"auto",border:"2px lightgrey solid",margin:"16px"},text:{fontSize:"13px",lineHeight:"normal",margin:"6px",wordBreak:"break-all"},buttonArea:{marginRight:"16px",alignSelf:"flex-end"}}}),{withTheme:!0})(m)}},[[415,1,2]]]);
//# sourceMappingURL=main.2801c81f.chunk.js.map