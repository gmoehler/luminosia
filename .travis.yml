branches:
  only:
  - master

cache:
  directories:
  - node_modules

matrix:
  include:
    #########################################
    # Static web deployment to github pages #
    #########################################
    - name: static_web
      language: node_js
      node_js:
      - "stable"
      script:
      - npm test
      - npm run build

      deploy:
        provider: pages
        skip_cleanup: true
        github_token: $GITHUB_TOKEN
        local_dir: build
        on:
          branch: master

    ############################################
    # Electron build and deploy to gh releases #
    ############################################
    - name: electron
      language: node_js
      node_js:
      - "lts"
      os: windows
      script:
      - yarn electron-pack

      deploy:
        provider: releases
        skip_cleanup: true
        github_token: $GITHUB_TOKEN
        on:
          tags: true
